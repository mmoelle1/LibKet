<!DOCTYPE html>



<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Local Reality and the CHSH Inequality</title>
  <meta name="description" content="A cross-platform programming framework for quantum-accelerated scientific computing">

  <link rel="canonical" href="https://libket.ewi.tudelft.nl/textbook/ch-demos/chsh.html">
  <link rel="alternate" type="application/rss+xml" title="LibKet Learn" href="https://libket.ewi.tudelft.nl/textbook/feed.xml">

  

  <link rel="alternate" hreflang="en" href="https://libket.ewi.tudelft.nl/textbook/ch-demos/chsh.html" />
  <link rel="alternate" hreflang="ja" href="https://libket.ewi.tudelft.nl/textbook/ja/ch-demos/chsh.html" />
  <link rel="alternate" hreflang="x-default" href="https://libket.ewi.tudelft.nl/textbook/ch-demos/chsh.html" />

  <meta property="og:url"         content="https://libket.ewi.tudelft.nl/textbook/ch-demos/chsh.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Local Reality and the CHSH Inequality" />
<meta property="og:description" content="A cross-platform programming framework for quantum-accelerated scientific computing" />
<meta property="og:image"       content="https://libket.ewi.tudelft.nl/textbook/images/preface_illustration.svg" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://libket.ewi.tudelft.nl/textbook/ch-demos/chsh.html",
  "headline": "Local Reality and the CHSH Inequality",
  "datePublished": "2021-04-27T15:33:01+00:00",
  "dateModified": "2021-04-27T15:33:01+00:00",
  "description": "        Local Reality and the CHSH Inequality    We have seen in a previous module how quantum entanglement results in strong correlations in a multi-partite...",
  "author": {
    "@type": "Person",
    "name": "The LibKet Team"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://libket.ewi.tudelft.nl/textbook",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://libket.ewi.tudelft.nl/textbook",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link id="theme-style" rel="stylesheet" href="/textbook/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/textbook/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe' async></script>


  <!-- DOM updating function -->
  <script src="/textbook/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/textbook/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/textbook';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/textbook/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <!-- Turbolinks were causing problems with equations in details tags, I have
	  removed them for now as I didn't notice a siginificant difference in
	  loading time, but maybe someone more knowledgeable than me can sort
	  the problem properly and re-enable -Frank
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">
  -->

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


<!-- Display Thebelab button in each code cell -->
<script>
/**
 * Set up thebelab button for code blocks
 */

const thebelabCellButton = id =>
  `<a id="thebelab-cell-button-${id}" class="btn thebebtn">
    <button>try</button>
  </a>`


const addThebelabButtonToCodeCells =  () => {

  const codeCells = document.querySelectorAll('div.input_area > div.highlight:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("thebelab-cell-button-" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', thebelabCellButton(id));
    }
  })
}

initFunction(addThebelabButtonToCodeCells);
</script>



<script>
    /**
     * Thebelab loads "reset CSS" after the theme styles load and so,
     * it invalidates part of the theme rules. To make the theme CSS to take
     * the correct precedence, we listen for Thebelab to finish loading, then
     * relocate the theme CSS and start Thebelab.
     */
    const thebeLabScript = document.createElement('script');
    thebeLabScript.src = "/textbook/assets/vendor/thebelab/index.js"
    thebeLabScript.async = true
    thebeLabScript.onload = () => {
        setTimeout(() => {
            document.head.append(
                ...document.querySelectorAll('#theme-style, #custom-style'))
        })
        initFunction(initThebelab)
    }
    document.head.append(thebeLabScript);

    /**
     * Add attributes to Thebelab blocks
     */
    function initThebelab() {
        const addThebelabToCodeCells = () => {
            console.log("Adding thebelab to code cells...");
            // If Thebelab hasn't loaded, wait a bit and try again. This
            // happens because we load ClipboardJS asynchronously.
            if (window.thebelab === undefined) {
                setTimeout(addThebelabToCodeCells, 250)
            return
            }

            // If we already detect a Thebelab cell, don't re-run
            if (document.querySelectorAll('div.thebelab-cell').length > 0) {
                return;
            }

            // Find all non-hardware, code cells, replace with Thebelab interactive code cells
            const hardwareTag = 'uses-hardware'
            const hardwareQuery = `.jb_cell.tag_${hardwareTag}`
            const noHardwareQuery = `.jb_cell:not(.tag_${hardwareTag})`
            const codeCells = document.querySelectorAll(`${noHardwareQuery} pre[id^="codecell"]`)
            codeCells.forEach((codeCell, index) => {
                const id = codeCellId(index)

                // Clean up the language to make it work w/ CodeMirror and add it to the cell
                dataLanguage = ""
                dataLanguage = detectLanguage(dataLanguage);
                codeCell.setAttribute('data-language', dataLanguage)
                codeCell.setAttribute('data-executable', 'true')

                // If the code cell is hidden, show it
                var inputCheckbox = document.querySelector(`input#hidebtn${codeCell.id}`);
                if (inputCheckbox !== null) {
                    setCodeCellVisibility(inputCheckbox, 'visible');
                }
            });

            // Create link to IQX and hardware notice template
            const currentPath = window.location.pathname
            const contentPath = currentPath.slice('/textbook'.length)
            const notebookPath = contentPath.replace(/\.html$/, '.ipynb')
            const iqxUrl = `https://quantum-computing.ibm.com/jupyter/user/qiskit-textbook/content${notebookPath}`

            const usesHardwareNotice = document.createElement('template')
            usesHardwareNotice.innerHTML = `
            <div class="uses-hardware-notice">
                This cell uses quantum hardware. To run it in your browser, please 
                <a href="${iqxUrl}" target="_blank">click here to go to the IBM Quantum Experience.</a>
            </div>
            `

            // Add warning and link to IQX on uses-hardware cells
            const hardwareCells = document.querySelectorAll(hardwareQuery)
            hardwareCells.forEach((cell) => {
                cell.prepend(usesHardwareNotice.content.cloneNode(true))
                cell.querySelector('a').addEventListener('click', (evt) => {
                    try {
                        window.trackCta(`Hardware Cell ${getInputCell(evt.target)}`)
                    } catch {}
                    return true;
                })
            });

            // Remove the event listener from the page so keyboard press doesn't
            // Change page
            document.removeEventListener('keydown', initPageNav)
            keyboardListener = false;

            // Init thebelab
            thebelab.bootstrap();

            // Remove copy buttons since they won't work anymore
            const copyAndThebeButtons = document.querySelectorAll(`${noHardwareQuery} .copybtn, .thebebtn`)
            copyAndThebeButtons.forEach((button, index) => {
                button.remove();
            });

            // Remove outputs since they'll be stale (ignore outputs with removed inputs)
            const outputs = document.querySelectorAll(':not(.tag_remove_input) > .output_wrapper')
            outputs.forEach((output, index) => {
                output.remove();
            });

            // Find any cells with an initialization tag and ask ThebeLab to run them when ready
            var thebeInitCells = document.querySelectorAll('div.tag_thebelab-init');
            thebeInitCells.forEach((cell) => {
                console.log("Initializing ThebeLab with cell: " + cell.id);
                cell.querySelector('.thebelab-run-button').click();
            });

            // Add analytics per cell
            const thebelabRunButtons = document.querySelectorAll('.thebelab-run-button');
            thebelabRunButtons.forEach((runButton) => {
                runButton.addEventListener('click', (evt) => {
                    window.trackCta(`Run ${getInputCell(evt.target)}`)
                })
            });
        }

        // Add event listener for the function to modify code cells
        const thebelabButtons = document.querySelectorAll('[id^=thebelab], [id$=thebelab]')
        thebelabButtons.forEach((thebelabButton,index) => {
            if (thebelabButton === null) {
                setTimeout(initThebelab, 250)
                return
            };
            thebelabButton.addEventListener('click', addThebelabToCodeCells);
            // Add segment analytics
            thebelabButton.addEventListener('click', () => {
                window.trackCta('Make Interactive');
            });
        });

        function getInputCell(button) {
            const parent = button.parentElement;
            if (parent === null) {
                return 'unknown';
            }
            if (parent.id.startsWith('inputcell')) {
                return parent.id;
            }
            return getInputCell(parent);
        }
    }

// Helper function to munge the language name
var detectLanguage = (language) => {
    if (language.indexOf('python') > -1) {
        language = "python";
    }
    return language;
}
</script>



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/textbook/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  


  <!-- Segment analytics -->
  <script>
(function () {
  'use strict'
  window._analytics = {
    segment_key: 'ffdYLviQze3kzomaINXNk6NwpY9LlXcw',
    coremetrics: false,
    optimizely: false,
    googleAddServices: false,
    fullStory: false,
    autoPageEventSpa: false,
    autoFormEvents: false,
    autoPageView: false
  }

  window.digitalData = {
    page: {
      pageInfo: {
        productTitle: 'IBM Q Experience',
        analytics: {
          category: 'Qiskit.org'
        }
      }
    }
  }

  loadAsyncScript('https://cloud.ibm.com/analytics/build/bluemix-analytics.min.js')
  .then(() => {
    if (!window.bluemixAnalytics || !window.digitalData) { return }

    const category = window.digitalData.page.pageInfo.analytics.category
    const productTitle = window.digitalData.page.pageInfo.productTitle
    const routeName = 'qiskit-textbook'

    window.bluemixAnalytics.pageEvent(category, routeName, {
      navigationType: 'pushState',
      productTitle: productTitle,
      title: document.title
    })
  })
  .catch((err) => {
    console.warn('Error loading Bluemix Analytics script:', err)
  })

  window.trackCta = (action) => {
    if (!window.bluemixAnalytics || !window.digitalData) { return }

    const category = window.digitalData.page.pageInfo.analytics.category
    const productTitle = window.digitalData.page.pageInfo.productTitle

    window.bluemixAnalytics.trackEvent('CTA Clicked', {
      productTitle,
      category,
      CTA: action
    })
  }

}());
</script>

  <!-- Hotjar -->
  <script>
  (function(h,o,t,j,a,r){
    h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
    h._hjSettings={hjid:1586421,hjsv:6};
    a=o.getElementsByTagName('head')[0];
    r=o.createElement('script');r.async=1;
    r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
    a.appendChild(r);
  })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>


  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/textbook/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/textbook/assets/custom/custom.js" async></script>
  <link id="custom-style" rel="stylesheet" href="/textbook/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("https://libket.ewi.tudelft.nl") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

// Fills in the search input with the query in the url
var prepopulateSearchInput = function () {
  var searchInput = document.getElementById('lunr_search');
  if (!searchInput) { return }

  var params = new URLSearchParams(window.location.search)
  var searchValue = params.get('search')
  if (!searchValue) { return }
  searchInput.value = searchValue.trim()
}

// Simulate a 'keyup' event to trigger a search
var triggerSearch = function () {
  var searchInput = document.getElementById('lunr_search');
  if (!searchInput || !searchInput.value.trim()) { return }

  searchInput.focus();
  var enterEvent = document.createEvent('Event');
  enterEvent.initEvent('keyup');
  searchInput.dispatchEvent(enterEvent);
}

initFunction(prepopulateSearchInput)

loadAsyncScript('https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js')
.then(() => {
  initFunction(initQuery)
  initFunction(triggerSearch)
})
.catch((err) => console.error('Cannot load lunr search engine:', err))
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/textbook/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/textbook/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/textbook/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "Made with Jupyter Book"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "mmoelle1/LibKet",
    ref: "master",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: "python"
    },
    kernelOptions: {
    kernelName: "python3",
    path: "content/ch-demos"
    }
}
</script>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
    <div id="libket-navbar" class="libket__navbar">
    


<ul class="libket-navbar">
    <li class="left navbar__logo">
	    <a href="https://libket.ewi.tudelft.nl/">
	    <img src="/textbook/assets/images/logo_libket_white.png">
	    </a>
    </li>
    <li class="libket-navbar__icons"><a href="/textbook/search.html"><img src="/textbook/assets/images/search-solid-purple.svg"></a></li>
    <li class="entry__active"><a href="https://libket.readthedocs.io/">Documentation</a></li>
 </ul>


    </div>

      






<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="/textbook/preface.html"><h2 class="c-sidebar__title">LibKet Learn</h2></a>
  <ul class="c-sidebar__chapters">
    
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/preface">
        <a class="c-sidebar__entry"
          href="/textbook/preface.html"
        >
          
          LibKet Learn
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/what-is-quantum">
        <a class="c-sidebar__entry"
          href="/textbook/what-is-quantum.html"
        >
          
          What is Quantum?
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-prerequisites/setting-the-environment.html">
        <a class="c-sidebar__entry"
          href="/textbook/ch-prerequisites/setting-the-environment.html"
        >
          
            0.
          
          Prerequisites
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-prerequisites/setting-the-environment">
              <a class="c-sidebar__entry"
                href="/textbook/ch-prerequisites/setting-the-environment.html"
              >
                
                  0.1
                
                Setting Up Your Environment
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-prerequisites/python-and-jupyter-notebooks">
              <a class="c-sidebar__entry"
                href="/textbook/ch-prerequisites/python-and-jupyter-notebooks.html"
              >
                
                  0.2
                
                Python and Jupyter Notebooks
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-cse21/index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-cse21/index"
        >
          
            1.
          
          SIAM CSE1 Tutorial
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-cse21/cse21-tutorial01">
              <a class="c-sidebar__entry"
                href="/textbook/ch-cse21/cse21-tutorial01.html"
              >
                
                  1.1
                
                Part 1
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-cse21/cse21-tutorial02">
              <a class="c-sidebar__entry"
                href="/textbook/ch-cse21/cse21-tutorial02.html"
              >
                
                  1.2
                
                Part 2
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-cse21/cse21-tutorial03">
              <a class="c-sidebar__entry"
                href="/textbook/ch-cse21/cse21-tutorial03.html"
              >
                
                  1.3
                
                Part 3
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-states/introduction.html">
        <a class="c-sidebar__entry"
          href="/textbook/ch-states/introduction.html"
        >
          
            2.
          
          Quantum States and Qubits
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/introduction">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/introduction.html"
              >
                
                  2.1
                
                Introduction
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/atoms-computation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/atoms-computation.html"
              >
                
                  2.2
                
                The Atoms of Computation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/representing-qubit-states">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/representing-qubit-states.html"
              >
                
                  2.3
                
                Representing Qubit States
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/single-qubit-gates">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/single-qubit-gates.html"
              >
                
                  2.4
                
                Single Qubit Gates
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/case-for-quantum">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/case-for-quantum.html"
              >
                
                  2.5
                
                The Case for Quantum
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-gates/introduction.html">
        <a class="c-sidebar__entry"
          href="/textbook/ch-gates/introduction.html"
        >
          
            3.
          
          Multiple Qubits and Entanglement
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/introduction">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/introduction.html"
              >
                
                  3.1
                
                Introduction
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/multiple-qubits-entangled-states">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/multiple-qubits-entangled-states.html"
              >
                
                  3.2
                
                Multiple Qubits and Entangled States
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/phase-kickback">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/phase-kickback.html"
              >
                
                  3.3
                
                Phase Kickback
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/more-circuit-identities">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/more-circuit-identities.html"
              >
                
                  3.4
                
                More Circuit Identities
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/proving-universality">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/proving-universality.html"
              >
                
                  3.5
                
                Proving Universality
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/oracles">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/oracles.html"
              >
                
                  3.6
                
                Classical Computation on a Quantum Computer
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-algorithms/index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-algorithms/index.html"
        >
          
            4.
          
          Quantum Protocols and Quantum Algorithms
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/defining-quantum-circuits">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/defining-quantum-circuits.html"
              >
                
                  4.1
                
                Defining Quantum Circuits
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/deutsch-jozsa">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/deutsch-jozsa.html"
              >
                
                  4.2
                
                Deutsch-Jozsa Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/bernstein-vazirani">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/bernstein-vazirani.html"
              >
                
                  4.3
                
                Bernstein-Vazirani Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/simon">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/simon.html"
              >
                
                  4.4
                
                Simon's Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/quantum-fourier-transform">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/quantum-fourier-transform.html"
              >
                
                  4.5
                
                Quantum Fourier Transform
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/quantum-phase-estimation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/quantum-phase-estimation.html"
              >
                
                  4.6
                
                Quantum Phase Estimation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/shor">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/shor.html"
              >
                
                  4.7
                
                Shor's Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/grover">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/grover.html"
              >
                
                  4.8
                
                Grover's Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/quantum-counting">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/quantum-counting.html"
              >
                
                  4.9
                
                Quantum Counting
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/teleportation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/teleportation.html"
              >
                
                  4.10
                
                Quantum Teleportation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/superdense-coding">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/superdense-coding.html"
              >
                
                  4.11
                
                Superdense Coding
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/quantum-key-distribution">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/quantum-key-distribution.html"
              >
                
                  4.12
                
                Quantum Key Distribution
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-applications/algs_for_apps_index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-applications/algs_for_apps_index.html"
        >
          
            5.
          
          Quantum Algorithms for Applications
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-applications/apps_index">
              <a class="c-sidebar__entry"
                href="/textbook/ch-applications/apps_index.html"
              >
                
                  5.1
                
                Applied Quantum Algorithms
              </a>
            </li>
            
              
              <ul class='c-sidebar__subsections'>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/hhl_tutorial">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/hhl_tutorial.html"
                  >
                    
                      5.1.1
                      
                    
                    Solving Linear Systems of Equations using HHL
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/vqe-molecules">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/vqe-molecules.html"
                  >
                    
                      5.1.2
                      
                    
                    Simulating Molecules using VQE
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/qaoa">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/qaoa.html"
                  >
                    
                      5.1.3
                      
                    
                    Solving combinatorial optimization problems using QAOA
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/satisfiability-grover">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/satisfiability-grover.html"
                  >
                    
                      5.1.4
                      
                    
                    Solving Satisfiability Problems using Grover's Algorithm
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-machine-learning/machine-learning-qiskit-pytorch">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-machine-learning/machine-learning-qiskit-pytorch.html"
                  >
                    
                      5.1.5
                      
                    
                    Hybrid quantum-classical Neural Networks with PyTorch and Qiskit
                  </a>
                </li>
              
              </ul>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-applications/imp_index">
              <a class="c-sidebar__entry"
                href="/textbook/ch-applications/imp_index.html"
              >
                
                  5.2
                
                Implementations of Recent Quantum Algorithms
              </a>
            </li>
            
              
              <ul class='c-sidebar__subsections'>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-paper-implementations/vqls">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-paper-implementations/vqls.html"
                  >
                    
                      5.2.1
                      
                    
                    Variational Quantum Linear Solver
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/image-processing-frqi-neqr">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/image-processing-frqi-neqr.html"
                  >
                    
                      5.2.2
                      
                    
                    Quantum Image Processing - FRQI and NEQR Image Representations
                  </a>
                </li>
              
              </ul>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-quantum-hardware/index-circuits">
        <a class="c-sidebar__entry"
          href="/textbook/ch-quantum-hardware/index-circuits.html"
        >
          
            6.
          
          Investigating Quantum Hardware Using Quantum Circuits
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/error-correction-repetition-code">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/error-correction-repetition-code.html"
              >
                
                  6.1
                
                Introduction to Quantum Error Correction using Repetition Codes
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/measurement-error-mitigation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/measurement-error-mitigation.html"
              >
                
                  6.2
                
                Measurement Error Mitigation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/randomized-benchmarking">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/randomized-benchmarking.html"
              >
                
                  6.3
                
                Randomized Benchmarking
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/measuring-quantum-volume">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/measuring-quantum-volume.html"
              >
                
                  6.4
                
                Measuring Quantum Volume
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-quantum-hardware/index-pulses">
        <a class="c-sidebar__entry"
          href="/textbook/ch-quantum-hardware/index-pulses.html"
        >
          
            7.
          
          Investigating Quantum Hardware Using Microwave Pulses
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/calibrating-qubits-pulse">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/calibrating-qubits-pulse.html"
              >
                
                  7.1
                
                Calibrating Qubits with Qiskit Pulse
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/accessing_higher_energy_states">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/accessing_higher_energy_states.html"
              >
                
                  7.2
                
                Accessing Higher Energy States
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/transmon-physics">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/transmon-physics.html"
              >
                
                  7.3
                
                Introduction to Transmon Physics
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/cQED-JC-SW">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/cQED-JC-SW.html"
              >
                
                  7.4
                
                Circuit Quantum Electrodynamics
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/Jaynes-Cummings-model">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/Jaynes-Cummings-model.html"
              >
                
                  7.5
                
                Exploring the Jaynes-Cummings Hamiltonian with Qiskit Pulse
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/ac-Stark-shift">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/ac-Stark-shift.html"
              >
                
                  7.6
                
                Measuring the Qubit ac-Stark Shift
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/hamiltonian-tomography">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/hamiltonian-tomography.html"
              >
                
                  7.7
                
                Hamiltonian Tomography
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-labs/index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-labs/index.html"
        >
          
            8.
          
          Quantum Computing Labs
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab01_QuantumCircuits">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab01_QuantumCircuits.html"
              >
                
                Lab 1. Quantum Circuits
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab02_QuantumMeasurement">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab02_QuantumMeasurement.html"
              >
                
                Lab 2. Quantum Measurement
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab03_AccuracyQPE">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab03_AccuracyQPE.html"
              >
                
                Lab 3. Accuracy of Quantum Phase Estimation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab04_IterativePhaseEstimation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab04_IterativePhaseEstimation.html"
              >
                
                Lab 4. Iterative Quantum Phase Estimation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab05_Scalable_Shor_Algorithm">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab05_Scalable_Shor_Algorithm.html"
              >
                
                Lab 5. Scalable Shor’s Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab06_Grover_search_with_an_unknown_number_of_solutions">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab06_Grover_search_with_an_unknown_number_of_solutions.html"
              >
                
                Lab 6. Grover's search with an unknown number of solutions
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab07_QuantumSimulationSearchAlgorithm">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab07_QuantumSimulationSearchAlgorithm.html"
              >
                
                Lab 7. Quantum Simulation as a Search Algorithm
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-appendix/index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-appendix/index.html"
        >
          
            9.
          
          Appendix
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-appendix/linear_algebra">
              <a class="c-sidebar__entry"
                href="/textbook/ch-appendix/linear_algebra.html"
              >
                
                  9.1
                
                Linear Algebra
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-appendix/qiskit">
              <a class="c-sidebar__entry"
                href="/textbook/ch-appendix/qiskit.html"
              >
                
                  9.2
                
                Qiskit
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-demos/index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-demos/index.html"
        >
          
            10.
          
          Games & Demos
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-ex/hello-qiskit">
              <a class="c-sidebar__entry"
                href="/textbook/ch-ex/hello-qiskit.html"
              >
                
                Hello Qiskit Game
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-demos/piday-code">
              <a class="c-sidebar__entry"
                href="/textbook/ch-demos/piday-code.html"
              >
                
                Estimating Pi Using Quantum Phase Estimation Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-demos/chsh">
              <a class="c-sidebar__entry"
                href="/textbook/ch-demos/chsh.html"
              >
                
                Local Reality and the CHSH Inequality
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/widgets-index">
              <a class="c-sidebar__entry"
                href="/textbook/widgets-index.html"
              >
                
                Interactivity Index
              </a>
            </li>
            
            
          
        </ul>
      

      
    
  </ul>
  <div class="sidebar_footer">
    <!-- Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a> -->
    
    <div class="language_switcher">
      <select name="preferred_language" onchange="changeLocale('', this.value)">
        <option value="en" >English</option>
      </select>
    </div>

  </div>
</nav>

      
      

<div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="hamburger__left">
    <span id="js-sidebar-toggle" class="hamburger is-active">
	    <img class="sidebar_closed_img" src="/textbook/assets/images/rightarrow_purple.svg" title="Show Contents">
	    <img class="sidebar_open_img" src="/textbook/assets/images/leftarrow_purple.svg" title="Hide Contents">
    </span>
  </aside>
  
  <aside class="sidebar__right">
  
    <!-- Search form -->
    <header>
      <form action="/textbook/search.html" method="GET">
        <button type="submit" id="submit">
          <img src="/textbook/assets/images/search-solid.svg" alt="Search">
        </button>
        <input type="text" id="siderbar-search-input" name="search">
      </form>
    </header>

    
    <div class="onthispage__title">On This Page</div>
    <nav class="onthispage">
    </nav>
    <!-- Chapter formats -->
    
    <div>
      <a
        href="/textbook/content/ch-demos/chsh.ipynb"
        rel="noopener"
        class="download__link"
      >
        Download as Jupyter Notebook
        <img src="/textbook/assets/images/download-solid.svg" class="download-button">
      </a>
    </div>
   <div>
      <a
	href="https://github.com/mmoelle1/LibKet/tree/master/content/ch-demos/chsh.ipynb"
	class="download__link"
      >
      Contribute on Github
      <img src="/textbook/assets/images/launch.svg" class="download-button">
      </a>
    </div>
    
  
  </aside>
  <!--
  <a href="/textbook/search.html" class="topbar-right-button" id="search-button">
    <img src="/textbook/assets/images/search-solid.svg" alt="Search" />
  </a>
  -->
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Local Reality and the CHSH Inequality</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have seen in a previous module how quantum entanglement results in strong correlations in a multi-partite system. In fact these correlations appear to be stronger than anything that could be explained using classical physics.</p>
<p>The historical development of quantum mechanics is filled with agitated discussions about the true nature of reality and the extent to which quantum mechanics can explain it. Given the spectacular empirical success of quantum mechanics, it was going to be clear that people would not simply give it up just because some of its aspects were hard to reconcile with intuition.</p>
<p>At the root of these different points of views was the question of the nature of measurement. We know there is an element of randomness in quantum measurements, but is that really so? Is there a sneaky way by which the Universe has already decided beforehand which value a given measurement is going to yield at a future time? This hypothesis was the basis for different <em>hidden variable</em> theories. But these theories did not only need to explain randomness at the single particle level. They also needed to explain what happens when different observers measure different parts of a multi-partite entangled system! This went beyond just hidden variable theories. Now a local hidden variable theory was needed in order to reconcile the observations of quantum mechanics with a Universe in which local reality was valid.</p>
<p>What is local reality? In an Universe where locality holds, it should be possible to separate two systems so far in space that they could not interact with each other. The concept of reality is related to whether a measurable quantity holds a particular value <em>in the absence of any future measurement</em>.</p>
<p>In 1963, John Stewart Bell published what could be argued as one of the most profound discoveries in the history of science. Bell stated that any theory invoking local hidden variables could be experimentally ruled out. In this section we are going to see how, and we will run a real experiment that demonstrates so! (with some remaining loopholes to close...)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-CHSH-inequality">The CHSH inequality<a class="anchor-link" href="#The-CHSH-inequality"> </a></h3><p>Imagine Alice and Bob are given each one part of a bipartite entangled system. Each of them then performs two measurements on their part in two different bases. Let's call Alice's bases <em>A</em> and <em>a</em> and Bob's <em>B</em> and <em>b</em>. What is the expectation value of the quantity $\langle CHSH \rangle = \langle AB \rangle - \langle Ab \rangle + \langle aB \rangle + \langle ab \rangle$ ?</p>
<p>Now, Alice and Bob have one qubit each, so any measurement they perform on their system (qubit) can only yield one of two possible outcomes: +1 or -1. Note that whereas we typically refer to the two qubit states as $|0\rangle$ and $|1\rangle$, these are <em>eigenstates</em>, and a projective measurement will yield their <em>eigenvalues</em>, +1 and -1, respectively.</p>
<p>Therefore, if any measurement of <em>A</em>, <em>a</em>, <em>B</em>, and <em>b</em> can only yield $\pm 1$, the quantities $(B-b)$ and $(B+b)$ can only be 0 or $\pm2$. And thus, the quantity $A(B-b) + a(B+b)$ can only be either +2 or -2, which means that there should be a bound for the expectation value of the quantity we have called $|\langle CHSH \rangle| =|\langle AB \rangle - \langle Ab \rangle + \langle aB \rangle + \langle ab \rangle| \leq 2$.</p>
<p>Now, the above discussion is oversimplified, because we could consider that the outcome on any set of measurements from Alice and Bob could depend on a set of local hidden variables, but it can be shown with some math that, even when that is the case, the expectation value of the quantity $CHSH$ should be bounded by 2 if local realism held.</p>
<p>But what happens when we do these experiments with an entangled system? Let's try it!</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#import qiskit tools</span>
<span class="kn">import</span> <span class="nn">qiskit</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">ClassicalRegister</span><span class="p">,</span> <span class="n">QuantumRegister</span><span class="p">,</span> <span class="n">execute</span><span class="p">,</span> <span class="n">transpile</span><span class="p">,</span> <span class="n">Aer</span><span class="p">,</span> <span class="n">IBMQ</span>
<span class="kn">from</span> <span class="nn">qiskit.tools.visualization</span> <span class="kn">import</span> <span class="n">circuit_drawer</span>
<span class="kn">from</span> <span class="nn">qiskit.tools.monitor</span> <span class="kn">import</span> <span class="n">job_monitor</span><span class="p">,</span> <span class="n">backend_monitor</span><span class="p">,</span> <span class="n">backend_overview</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.aer</span> <span class="kn">import</span> <span class="n">noise</span>

<span class="c1">#import python stuff</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell tag_uses-hardware">

<div class="cell border-box-sizing code_cell rendered tag_uses-hardware">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Set devices, if using a real device</span>
<span class="n">IBMQ</span><span class="o">.</span><span class="n">load_account</span><span class="p">()</span>
<span class="n">provider</span> <span class="o">=</span> <span class="n">IBMQ</span><span class="o">.</span><span class="n">get_provider</span><span class="p">(</span><span class="n">hub</span><span class="o">=</span><span class="s1">&#39;ibm-q&#39;</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">)</span>
<span class="n">lima</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;ibmq_lima&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sv_sim</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">)</span>
<span class="n">qasm_sim</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;qasm_simulator&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we are going to define a function to create our CHSH circuits. We are going to choose, without loss of generality, that Bob always uses the computational ($Z$) and the $X$ bases for his $B$ and $b$ measurements, respectively, whereas Alice chooses also orthogonal bases but whose angle we are going to vary between $0$ and $2\pi$ with respect to Bob's bases. This set of angles is going to be the input argument to our $CHSH$ circuit building function.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_chsh_circuit</span><span class="p">(</span><span class="n">theta_vec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a list of QuantumCircuits for use in a CHSH experiemnt</span>
<span class="sd">    (one for each value of theta in theta_vec)</span>
<span class="sd">    </span>
<span class="sd">        Args:</span>
<span class="sd">            theta_vec (list): list of values of angles between the bases of Alice and Bob</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            List[QuantumCircuit]: CHSH QuantumCircuits for each value of theta</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chsh_circuits</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">theta_vec</span><span class="p">:</span>
        <span class="n">obs_vec</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;00&#39;</span><span class="p">,</span> <span class="s1">&#39;01&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;11&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">obs_vec</span><span class="p">:</span>
            <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">qc</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">qc</span><span class="o">.</span><span class="n">ry</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">el</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
                    <span class="n">qc</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> 
            <span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
            <span class="n">chsh_circuits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">chsh_circuits</span>  
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we are going to define a function for estimating the quantity $\langle CHSH \rangle$. One can define two of such quantities, actually, $\langle CHSH1 \rangle = \langle AB \rangle - \langle Ab \rangle + \langle aB \rangle + \langle ab \rangle$ and $\langle CHSH2 \rangle = \langle AB \rangle + \langle Ab \rangle - \langle aB \rangle + \langle ab \rangle$. Once chosen the corresponding measurement axes for both parties, each expectation value can be simply estimated by adding the counts from the output bitstrings with the appropiate sign (plus for the even terms $00$ and $11$ and minus for odd terms $01$ and $10$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">compute_chsh_witness</span><span class="p">(</span><span class="n">counts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Computes expectation values for the CHSH inequality, for each</span>
<span class="sd">    angle (theta) between measurement axis.</span>

<span class="sd">        Args: counts (list[dict]): dict of counts for each experiment</span>
<span class="sd">              (4 per value of theta)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple(List, List): Tuple of lists with the two CHSH witnesses</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Order is ZZ,ZX,XZ,XX</span>
    
    <span class="n">CHSH1</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">CHSH2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Divide the list of dictionaries in sets of 4</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">counts</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>  
        <span class="n">theta_dict</span> <span class="o">=</span> <span class="n">counts</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span>
        <span class="n">zz</span> <span class="o">=</span> <span class="n">theta_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">zx</span> <span class="o">=</span> <span class="n">theta_dict</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">xz</span> <span class="o">=</span> <span class="n">theta_dict</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">xx</span> <span class="o">=</span> <span class="n">theta_dict</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

        <span class="n">no_shots</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">xx</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">xx</span><span class="p">)</span>

        <span class="n">chsh1</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">chsh2</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">zz</span><span class="p">:</span>
            <span class="n">parity</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">chsh1</span><span class="o">+=</span> <span class="n">parity</span><span class="o">*</span><span class="n">zz</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
            <span class="n">chsh2</span><span class="o">+=</span> <span class="n">parity</span><span class="o">*</span><span class="n">zz</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">zx</span><span class="p">:</span>
            <span class="n">parity</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">chsh1</span><span class="o">+=</span> <span class="n">parity</span><span class="o">*</span><span class="n">zx</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
            <span class="n">chsh2</span><span class="o">-=</span> <span class="n">parity</span><span class="o">*</span><span class="n">zx</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">xz</span><span class="p">:</span>
            <span class="n">parity</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">chsh1</span><span class="o">-=</span> <span class="n">parity</span><span class="o">*</span><span class="n">xz</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
            <span class="n">chsh2</span><span class="o">+=</span> <span class="n">parity</span><span class="o">*</span><span class="n">xz</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">xx</span><span class="p">:</span>
            <span class="n">parity</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">chsh1</span><span class="o">+=</span> <span class="n">parity</span><span class="o">*</span><span class="n">xx</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
            <span class="n">chsh2</span><span class="o">+=</span> <span class="n">parity</span><span class="o">*</span><span class="n">xx</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>

        <span class="n">CHSH1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chsh1</span><span class="o">/</span><span class="n">no_shots</span><span class="p">)</span>
        <span class="n">CHSH2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chsh2</span><span class="o">/</span><span class="n">no_shots</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">CHSH1</span><span class="p">,</span> <span class="n">CHSH2</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we are going to split the interval $[0, 2\pi)$ into 15 angles and will build the corresponding set of $CHSH$ circuits</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">number_of_thetas</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">theta_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span><span class="n">number_of_thetas</span><span class="p">)</span>
<span class="n">my_chsh_circuits</span> <span class="o">=</span> <span class="n">make_chsh_circuit</span><span class="p">(</span><span class="n">theta_vec</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let's have a brief look at how four of these circuits look like for a given $\theta$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_chsh_circuits</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="168.9334pt" version="1.1" viewBox="0 0 261.475272 168.9334" width="261.475272pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <defs>
  <style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 168.9334 
L 261.475272 168.9334 
L 261.475272 0 
L 0 0 
z
" style="fill:#ffffff;"/>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path clip-path="url(#pbf6ab762a5)" d="M 172.917982 124.122697 
L 184.735242 124.122697 
L 178.826612 132.64476 
z
" style="fill:#778899;"/>
   </g>
   <g id="patch_3">
    <path clip-path="url(#pbf6ab762a5)" d="M 218.368982 124.122697 
L 230.186242 124.122697 
L 224.277612 132.64476 
z
" style="fill:#778899;"/>
   </g>
   <g id="line2d_1">
    <path clip-path="url(#pbf6ab762a5)" d="M 63.381072 43.5608 
L 249.730172 43.5608 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_2">
    <path clip-path="url(#pbf6ab762a5)" d="M 63.381072 89.0118 
L 249.730172 89.0118 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_3">
    <path clip-path="url(#pbf6ab762a5)" d="M 63.381072 132.985642 
L 249.730172 132.985642 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_4">
    <path clip-path="url(#pbf6ab762a5)" d="M 63.381072 135.939957 
L 249.730172 135.939957 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_5">
    <path clip-path="url(#pbf6ab762a5)" d="M 133.375612 89.0118 
L 133.375612 43.5608 
" style="fill:none;stroke:#6fa4ff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_6">
    <path clip-path="url(#pbf6ab762a5)" d="M 180.30377 89.0118 
L 180.30377 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_7">
    <path clip-path="url(#pbf6ab762a5)" d="M 177.349455 89.0118 
L 177.349455 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_8">
    <path clip-path="url(#pbf6ab762a5)" d="M 225.75477 43.5608 
L 225.75477 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_9">
    <path clip-path="url(#pbf6ab762a5)" d="M 222.800455 43.5608 
L 222.800455 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_10">
    <path clip-path="url(#pbf6ab762a5)" d="M 72.471272 139.0079 
L 77.016372 129.9177 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:1.5;"/>
   </g>
   <g id="patch_4">
    <path clip-path="url(#pbf6ab762a5)" d="M 73.153037 58.332375 
L 102.696187 58.332375 
L 102.696187 28.789225 
L 73.153037 28.789225 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_5">
    <path clip-path="url(#pbf6ab762a5)" d="M 133.375612 47.992272 
C 134.550852 47.992272 135.678116 47.525345 136.509136 46.694324 
C 137.340157 45.863304 137.807085 44.73604 137.807085 43.5608 
C 137.807085 42.38556 137.340157 41.258296 136.509136 40.427276 
C 135.678116 39.596255 134.550852 39.129327 133.375612 39.129327 
C 132.200372 39.129327 131.073108 39.596255 130.242088 40.427276 
C 129.411067 41.258296 128.94414 42.38556 128.94414 43.5608 
C 128.94414 44.73604 129.411067 45.863304 130.242088 46.694324 
C 131.073108 47.525345 132.200372 47.992272 133.375612 47.992272 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_6">
    <path clip-path="url(#pbf6ab762a5)" d="M 133.375612 99.351902 
C 136.117839 99.351902 138.748121 98.262404 140.687169 96.323357 
C 142.626216 94.384309 143.715715 91.754027 143.715715 89.0118 
C 143.715715 86.269573 142.626216 83.639291 140.687169 81.700243 
C 138.748121 79.761196 136.117839 78.671697 133.375612 78.671697 
C 130.633385 78.671697 128.003103 79.761196 126.064055 81.700243 
C 124.125008 83.639291 123.03551 86.269573 123.03551 89.0118 
C 123.03551 91.754027 124.125008 94.384309 126.064055 96.323357 
C 128.003103 98.262404 130.633385 99.351902 133.375612 99.351902 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="patch_7">
    <path clip-path="url(#pbf6ab762a5)" d="M 164.055037 58.332375 
L 193.598187 58.332375 
L 193.598187 28.789225 
L 164.055037 28.789225 
z
" style="fill:#bb8bff;stroke:#bb8bff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_8">
    <path clip-path="url(#pbf6ab762a5)" d="M 164.055037 103.783375 
L 193.598187 103.783375 
L 193.598187 74.240225 
L 164.055037 74.240225 
z
" style="stroke:#000000;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_9">
    <path clip-path="url(#pbf6ab762a5)" d="M 189.166715 93.443272 
C 189.166715 90.701959 188.07657 88.070118 186.138169 86.131716 
C 184.199767 84.193314 181.567926 83.10317 178.826612 83.10317 
C 176.085298 83.10317 173.453457 84.193314 171.515055 86.131716 
C 169.576654 88.070118 168.48651 90.701959 168.48651 93.443272 
" style="fill:none;stroke:#ffffff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="patch_10">
    <path clip-path="url(#pbf6ab762a5)" d="M 209.506037 58.332375 
L 239.049187 58.332375 
L 239.049187 28.789225 
L 209.506037 28.789225 
z
" style="stroke:#000000;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_11">
    <path clip-path="url(#pbf6ab762a5)" d="M 234.617715 47.992272 
C 234.617715 45.250959 233.52757 42.619118 231.589169 40.680716 
C 229.650767 38.742314 227.018926 37.65217 224.277612 37.65217 
C 221.536298 37.65217 218.904457 38.742314 216.966055 40.680716 
C 215.027654 42.619118 213.93751 45.250959 213.93751 47.992272 
" style="fill:none;stroke:#ffffff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="line2d_11">
    <path clip-path="url(#pbf6ab762a5)" d="M 178.826612 93.443272 
L 189.166715 83.10317 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_12">
    <path clip-path="url(#pbf6ab762a5)" d="M 224.277612 47.992272 
L 234.617715 37.65217 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_13">
    <path clip-path="url(#pbf6ab762a5)" d="M 133.375612 94.92043 
L 133.375612 83.10317 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_14">
    <path clip-path="url(#pbf6ab762a5)" d="M 127.466982 89.0118 
L 139.284242 89.0118 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="text_1">
    <g clip-path="url(#pbf6ab762a5)">
     <!-- H -->
     <defs>
      <path d="M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 43.015625 
L 55.515625 43.015625 
L 55.515625 72.90625 
L 65.375 72.90625 
L 65.375 0 
L 55.515625 0 
L 55.515625 34.71875 
L 19.671875 34.71875 
L 19.671875 0 
L 9.8125 0 
z
" id="DejaVuSans-72"/>
     </defs>
     <g transform="translate(83.036409 47.147987)scale(0.13 -0.13)">
      <use xlink:href="#DejaVuSans-72"/>
     </g>
    </g>
   </g>
   <g id="text_2">
    <g clip-path="url(#pbf6ab762a5)">
     <!-- $\mathrm{R}_\mathrm{Y}$ -->
     <defs>
      <path d="M 44.390625 34.1875 
Q 47.5625 33.109375 50.5625 29.59375 
Q 53.5625 26.078125 56.59375 19.921875 
L 66.609375 0 
L 56 0 
L 46.6875 18.703125 
Q 43.0625 26.03125 39.671875 28.421875 
Q 36.28125 30.8125 30.421875 30.8125 
L 19.671875 30.8125 
L 19.671875 0 
L 9.8125 0 
L 9.8125 72.90625 
L 32.078125 72.90625 
Q 44.578125 72.90625 50.734375 67.671875 
Q 56.890625 62.453125 56.890625 51.90625 
Q 56.890625 45.015625 53.6875 40.46875 
Q 50.484375 35.9375 44.390625 34.1875 
z
M 19.671875 64.796875 
L 19.671875 38.921875 
L 32.078125 38.921875 
Q 39.203125 38.921875 42.84375 42.21875 
Q 46.484375 45.515625 46.484375 51.90625 
Q 46.484375 58.296875 42.84375 61.546875 
Q 39.203125 64.796875 32.078125 64.796875 
z
" id="DejaVuSans-82"/>
      <path d="M -0.203125 72.90625 
L 10.40625 72.90625 
L 30.609375 42.921875 
L 50.6875 72.90625 
L 61.28125 72.90625 
L 35.5 34.71875 
L 35.5 0 
L 25.59375 0 
L 25.59375 34.71875 
z
" id="DejaVuSans-89"/>
     </defs>
     <g transform="translate(171.286612 42.716515)scale(0.13 -0.13)">
      <use transform="translate(0 0.09375)" xlink:href="#DejaVuSans-82"/>
      <use transform="translate(70.439453 -16.3125)scale(0.7)" xlink:href="#DejaVuSans-89"/>
     </g>
    </g>
   </g>
   <g id="text_3">
    <g clip-path="url(#pbf6ab762a5)">
     <!-- $\pi$/7 -->
     <defs>
      <path d="M 9.125 54.6875 
L 61.53125 54.6875 
L 59.765625 45.703125 
L 52.875 45.703125 
L 46.34375 12.109375 
Q 45.65625 8.59375 46.578125 7.03125 
Q 47.46875 5.515625 50.140625 5.515625 
Q 50.875 5.515625 51.953125 5.671875 
Q 53.078125 5.765625 53.421875 5.8125 
L 52.15625 -0.6875 
Q 50.34375 -1.3125 48.484375 -1.609375 
Q 46.578125 -1.90625 44.78125 -1.90625 
Q 38.921875 -1.90625 37.3125 1.265625 
Q 35.6875 4.5 37.359375 13.09375 
L 43.703125 45.703125 
L 23.53125 45.703125 
L 14.65625 0 
L 5.46875 0 
L 14.359375 45.703125 
L 7.375 45.703125 
z
" id="DejaVuSans-Oblique-960"/>
      <path d="M 25.390625 72.90625 
L 33.6875 72.90625 
L 8.296875 -9.28125 
L 0 -9.28125 
z
" id="DejaVuSans-47"/>
      <path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"/>
     </defs>
     <g transform="translate(173.066612 54.631245)scale(0.08 -0.08)">
      <use transform="translate(0 0.09375)" xlink:href="#DejaVuSans-Oblique-960"/>
      <use transform="translate(60.205078 0.09375)" xlink:href="#DejaVuSans-47"/>
      <use transform="translate(80.146484 0.09375)" xlink:href="#DejaVuSans-55"/>
     </g>
    </g>
   </g>
   <g id="text_4">
    <g clip-path="url(#pbf6ab762a5)">
     <!-- 1 -->
     <defs>
      <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"/>
     </defs>
     <g transform="translate(190.189362 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-49"/>
     </g>
    </g>
   </g>
   <g id="text_5">
    <g clip-path="url(#pbf6ab762a5)">
     <!-- 0 -->
     <defs>
      <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"/>
     </defs>
     <g transform="translate(235.640362 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-48"/>
     </g>
    </g>
   </g>
   <g id="text_6">
    <g clip-path="url(#pbf6ab762a5)">
     <!-- ${q}_{0}$ -->
     <defs>
      <path d="M 41.703125 8.203125 
Q 38.09375 3.46875 33.171875 1.015625 
Q 28.265625 -1.421875 22.3125 -1.421875 
Q 14.015625 -1.421875 9.296875 4.171875 
Q 4.59375 9.765625 4.59375 19.578125 
Q 4.59375 27.484375 7.5 34.859375 
Q 10.40625 42.234375 15.828125 48.09375 
Q 19.34375 51.90625 23.90625 53.953125 
Q 28.46875 56 33.5 56 
Q 39.546875 56 43.453125 53.609375 
Q 47.359375 51.21875 49.125 46.390625 
L 50.6875 54.59375 
L 59.71875 54.59375 
L 45.125 -20.609375 
L 36.078125 -20.609375 
z
M 13.921875 20.90625 
Q 13.921875 13.671875 16.9375 9.890625 
Q 19.96875 6.109375 25.6875 6.109375 
Q 34.1875 6.109375 40.1875 14.234375 
Q 46.1875 22.359375 46.1875 33.984375 
Q 46.1875 41.015625 43.078125 44.75 
Q 39.984375 48.484375 34.1875 48.484375 
Q 29.9375 48.484375 26.3125 46.5 
Q 22.703125 44.53125 20.015625 40.71875 
Q 17.1875 36.71875 15.546875 31.34375 
Q 13.921875 25.984375 13.921875 20.90625 
z
" id="DejaVuSans-Oblique-113"/>
     </defs>
     <g transform="translate(36.253372 48.011777)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-Oblique-113"/>
      <use transform="translate(63.476562 -16.40625)scale(0.7)" xlink:href="#DejaVuSans-48"/>
     </g>
    </g>
   </g>
   <g id="text_7">
    <g clip-path="url(#pbf6ab762a5)">
     <!-- ${q}_{1}$ -->
     <g transform="translate(36.253372 93.462777)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-Oblique-113"/>
      <use transform="translate(63.476562 -16.40625)scale(0.7)" xlink:href="#DejaVuSans-49"/>
     </g>
    </g>
   </g>
   <g id="text_8">
    <g clip-path="url(#pbf6ab762a5)">
     <!-- 2 -->
     <defs>
      <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"/>
     </defs>
     <g transform="translate(67.926172 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-50"/>
     </g>
    </g>
   </g>
   <g id="text_9">
    <g clip-path="url(#pbf6ab762a5)">
     <!-- c -->
     <defs>
      <path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"/>
     </defs>
     <g transform="translate(45.355911 138.946784)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-99"/>
     </g>
    </g>
   </g>
  </g>
 </g>
 <defs>
  <clipPath id="pbf6ab762a5">
   <rect height="154.5334" width="247.075272" x="7.2" y="7.2"/>
  </clipPath>
 </defs>
</svg>

</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_chsh_circuits</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="168.9334pt" version="1.1" viewBox="0 0 306.926272 168.9334" width="306.926272pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <defs>
  <style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 168.9334 
L 306.926272 168.9334 
L 306.926272 0 
L 0 0 
z
" style="fill:#ffffff;"/>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path clip-path="url(#pc4d39b6756)" d="M 218.368982 124.122697 
L 230.186242 124.122697 
L 224.277612 132.64476 
z
" style="fill:#778899;"/>
   </g>
   <g id="patch_3">
    <path clip-path="url(#pc4d39b6756)" d="M 263.819982 124.122697 
L 275.637242 124.122697 
L 269.728612 132.64476 
z
" style="fill:#778899;"/>
   </g>
   <g id="line2d_1">
    <path clip-path="url(#pc4d39b6756)" d="M 63.381072 43.5608 
L 295.181172 43.5608 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_2">
    <path clip-path="url(#pc4d39b6756)" d="M 63.381072 89.0118 
L 295.181172 89.0118 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_3">
    <path clip-path="url(#pc4d39b6756)" d="M 63.381072 132.985642 
L 295.181172 132.985642 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_4">
    <path clip-path="url(#pc4d39b6756)" d="M 63.381072 135.939957 
L 295.181172 135.939957 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_5">
    <path clip-path="url(#pc4d39b6756)" d="M 133.375612 89.0118 
L 133.375612 43.5608 
" style="fill:none;stroke:#6fa4ff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_6">
    <path clip-path="url(#pc4d39b6756)" d="M 225.75477 43.5608 
L 225.75477 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_7">
    <path clip-path="url(#pc4d39b6756)" d="M 222.800455 43.5608 
L 222.800455 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_8">
    <path clip-path="url(#pc4d39b6756)" d="M 271.20577 89.0118 
L 271.20577 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_9">
    <path clip-path="url(#pc4d39b6756)" d="M 268.251455 89.0118 
L 268.251455 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_10">
    <path clip-path="url(#pc4d39b6756)" d="M 72.471272 139.0079 
L 77.016372 129.9177 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:1.5;"/>
   </g>
   <g id="patch_4">
    <path clip-path="url(#pc4d39b6756)" d="M 73.153037 58.332375 
L 102.696187 58.332375 
L 102.696187 28.789225 
L 73.153037 28.789225 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_5">
    <path clip-path="url(#pc4d39b6756)" d="M 133.375612 47.992272 
C 134.550852 47.992272 135.678116 47.525345 136.509136 46.694324 
C 137.340157 45.863304 137.807085 44.73604 137.807085 43.5608 
C 137.807085 42.38556 137.340157 41.258296 136.509136 40.427276 
C 135.678116 39.596255 134.550852 39.129327 133.375612 39.129327 
C 132.200372 39.129327 131.073108 39.596255 130.242088 40.427276 
C 129.411067 41.258296 128.94414 42.38556 128.94414 43.5608 
C 128.94414 44.73604 129.411067 45.863304 130.242088 46.694324 
C 131.073108 47.525345 132.200372 47.992272 133.375612 47.992272 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_6">
    <path clip-path="url(#pc4d39b6756)" d="M 133.375612 99.351902 
C 136.117839 99.351902 138.748121 98.262404 140.687169 96.323357 
C 142.626216 94.384309 143.715715 91.754027 143.715715 89.0118 
C 143.715715 86.269573 142.626216 83.639291 140.687169 81.700243 
C 138.748121 79.761196 136.117839 78.671697 133.375612 78.671697 
C 130.633385 78.671697 128.003103 79.761196 126.064055 81.700243 
C 124.125008 83.639291 123.03551 86.269573 123.03551 89.0118 
C 123.03551 91.754027 124.125008 94.384309 126.064055 96.323357 
C 128.003103 98.262404 130.633385 99.351902 133.375612 99.351902 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="patch_7">
    <path clip-path="url(#pc4d39b6756)" d="M 164.055037 58.332375 
L 193.598187 58.332375 
L 193.598187 28.789225 
L 164.055037 28.789225 
z
" style="fill:#bb8bff;stroke:#bb8bff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_8">
    <path clip-path="url(#pc4d39b6756)" d="M 164.055037 103.783375 
L 193.598187 103.783375 
L 193.598187 74.240225 
L 164.055037 74.240225 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_9">
    <path clip-path="url(#pc4d39b6756)" d="M 209.506037 58.332375 
L 239.049187 58.332375 
L 239.049187 28.789225 
L 209.506037 28.789225 
z
" style="stroke:#000000;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_10">
    <path clip-path="url(#pc4d39b6756)" d="M 234.617715 47.992272 
C 234.617715 45.250959 233.52757 42.619118 231.589169 40.680716 
C 229.650767 38.742314 227.018926 37.65217 224.277612 37.65217 
C 221.536298 37.65217 218.904457 38.742314 216.966055 40.680716 
C 215.027654 42.619118 213.93751 45.250959 213.93751 47.992272 
" style="fill:none;stroke:#ffffff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="patch_11">
    <path clip-path="url(#pc4d39b6756)" d="M 254.957037 103.783375 
L 284.500187 103.783375 
L 284.500187 74.240225 
L 254.957037 74.240225 
z
" style="stroke:#000000;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_12">
    <path clip-path="url(#pc4d39b6756)" d="M 280.068715 93.443272 
C 280.068715 90.701959 278.97857 88.070118 277.040169 86.131716 
C 275.101767 84.193314 272.469926 83.10317 269.728612 83.10317 
C 266.987298 83.10317 264.355457 84.193314 262.417055 86.131716 
C 260.478654 88.070118 259.38851 90.701959 259.38851 93.443272 
" style="fill:none;stroke:#ffffff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="line2d_11">
    <path clip-path="url(#pc4d39b6756)" d="M 224.277612 47.992272 
L 234.617715 37.65217 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_12">
    <path clip-path="url(#pc4d39b6756)" d="M 269.728612 93.443272 
L 280.068715 83.10317 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_13">
    <path clip-path="url(#pc4d39b6756)" d="M 133.375612 94.92043 
L 133.375612 83.10317 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_14">
    <path clip-path="url(#pc4d39b6756)" d="M 127.466982 89.0118 
L 139.284242 89.0118 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="text_1">
    <g clip-path="url(#pc4d39b6756)">
     <!-- H -->
     <defs>
      <path d="M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 43.015625 
L 55.515625 43.015625 
L 55.515625 72.90625 
L 65.375 72.90625 
L 65.375 0 
L 55.515625 0 
L 55.515625 34.71875 
L 19.671875 34.71875 
L 19.671875 0 
L 9.8125 0 
z
" id="DejaVuSans-72"/>
     </defs>
     <g transform="translate(83.036409 47.147987)scale(0.13 -0.13)">
      <use xlink:href="#DejaVuSans-72"/>
     </g>
    </g>
   </g>
   <g id="text_2">
    <g clip-path="url(#pc4d39b6756)">
     <!-- $\mathrm{R}_\mathrm{Y}$ -->
     <defs>
      <path d="M 44.390625 34.1875 
Q 47.5625 33.109375 50.5625 29.59375 
Q 53.5625 26.078125 56.59375 19.921875 
L 66.609375 0 
L 56 0 
L 46.6875 18.703125 
Q 43.0625 26.03125 39.671875 28.421875 
Q 36.28125 30.8125 30.421875 30.8125 
L 19.671875 30.8125 
L 19.671875 0 
L 9.8125 0 
L 9.8125 72.90625 
L 32.078125 72.90625 
Q 44.578125 72.90625 50.734375 67.671875 
Q 56.890625 62.453125 56.890625 51.90625 
Q 56.890625 45.015625 53.6875 40.46875 
Q 50.484375 35.9375 44.390625 34.1875 
z
M 19.671875 64.796875 
L 19.671875 38.921875 
L 32.078125 38.921875 
Q 39.203125 38.921875 42.84375 42.21875 
Q 46.484375 45.515625 46.484375 51.90625 
Q 46.484375 58.296875 42.84375 61.546875 
Q 39.203125 64.796875 32.078125 64.796875 
z
" id="DejaVuSans-82"/>
      <path d="M -0.203125 72.90625 
L 10.40625 72.90625 
L 30.609375 42.921875 
L 50.6875 72.90625 
L 61.28125 72.90625 
L 35.5 34.71875 
L 35.5 0 
L 25.59375 0 
L 25.59375 34.71875 
z
" id="DejaVuSans-89"/>
     </defs>
     <g transform="translate(171.286612 42.716515)scale(0.13 -0.13)">
      <use transform="translate(0 0.09375)" xlink:href="#DejaVuSans-82"/>
      <use transform="translate(70.439453 -16.3125)scale(0.7)" xlink:href="#DejaVuSans-89"/>
     </g>
    </g>
   </g>
   <g id="text_3">
    <g clip-path="url(#pc4d39b6756)">
     <!-- $\pi$/7 -->
     <defs>
      <path d="M 9.125 54.6875 
L 61.53125 54.6875 
L 59.765625 45.703125 
L 52.875 45.703125 
L 46.34375 12.109375 
Q 45.65625 8.59375 46.578125 7.03125 
Q 47.46875 5.515625 50.140625 5.515625 
Q 50.875 5.515625 51.953125 5.671875 
Q 53.078125 5.765625 53.421875 5.8125 
L 52.15625 -0.6875 
Q 50.34375 -1.3125 48.484375 -1.609375 
Q 46.578125 -1.90625 44.78125 -1.90625 
Q 38.921875 -1.90625 37.3125 1.265625 
Q 35.6875 4.5 37.359375 13.09375 
L 43.703125 45.703125 
L 23.53125 45.703125 
L 14.65625 0 
L 5.46875 0 
L 14.359375 45.703125 
L 7.375 45.703125 
z
" id="DejaVuSans-Oblique-960"/>
      <path d="M 25.390625 72.90625 
L 33.6875 72.90625 
L 8.296875 -9.28125 
L 0 -9.28125 
z
" id="DejaVuSans-47"/>
      <path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"/>
     </defs>
     <g transform="translate(173.066612 54.631245)scale(0.08 -0.08)">
      <use transform="translate(0 0.09375)" xlink:href="#DejaVuSans-Oblique-960"/>
      <use transform="translate(60.205078 0.09375)" xlink:href="#DejaVuSans-47"/>
      <use transform="translate(80.146484 0.09375)" xlink:href="#DejaVuSans-55"/>
     </g>
    </g>
   </g>
   <g id="text_4">
    <g clip-path="url(#pc4d39b6756)">
     <!-- H -->
     <g transform="translate(173.938409 92.598987)scale(0.13 -0.13)">
      <use xlink:href="#DejaVuSans-72"/>
     </g>
    </g>
   </g>
   <g id="text_5">
    <g clip-path="url(#pc4d39b6756)">
     <!-- 0 -->
     <defs>
      <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"/>
     </defs>
     <g transform="translate(235.640362 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-48"/>
     </g>
    </g>
   </g>
   <g id="text_6">
    <g clip-path="url(#pc4d39b6756)">
     <!-- 1 -->
     <defs>
      <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"/>
     </defs>
     <g transform="translate(281.091362 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-49"/>
     </g>
    </g>
   </g>
   <g id="text_7">
    <g clip-path="url(#pc4d39b6756)">
     <!-- ${q}_{0}$ -->
     <defs>
      <path d="M 41.703125 8.203125 
Q 38.09375 3.46875 33.171875 1.015625 
Q 28.265625 -1.421875 22.3125 -1.421875 
Q 14.015625 -1.421875 9.296875 4.171875 
Q 4.59375 9.765625 4.59375 19.578125 
Q 4.59375 27.484375 7.5 34.859375 
Q 10.40625 42.234375 15.828125 48.09375 
Q 19.34375 51.90625 23.90625 53.953125 
Q 28.46875 56 33.5 56 
Q 39.546875 56 43.453125 53.609375 
Q 47.359375 51.21875 49.125 46.390625 
L 50.6875 54.59375 
L 59.71875 54.59375 
L 45.125 -20.609375 
L 36.078125 -20.609375 
z
M 13.921875 20.90625 
Q 13.921875 13.671875 16.9375 9.890625 
Q 19.96875 6.109375 25.6875 6.109375 
Q 34.1875 6.109375 40.1875 14.234375 
Q 46.1875 22.359375 46.1875 33.984375 
Q 46.1875 41.015625 43.078125 44.75 
Q 39.984375 48.484375 34.1875 48.484375 
Q 29.9375 48.484375 26.3125 46.5 
Q 22.703125 44.53125 20.015625 40.71875 
Q 17.1875 36.71875 15.546875 31.34375 
Q 13.921875 25.984375 13.921875 20.90625 
z
" id="DejaVuSans-Oblique-113"/>
     </defs>
     <g transform="translate(36.253372 48.011777)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-Oblique-113"/>
      <use transform="translate(63.476562 -16.40625)scale(0.7)" xlink:href="#DejaVuSans-48"/>
     </g>
    </g>
   </g>
   <g id="text_8">
    <g clip-path="url(#pc4d39b6756)">
     <!-- ${q}_{1}$ -->
     <g transform="translate(36.253372 93.462777)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-Oblique-113"/>
      <use transform="translate(63.476562 -16.40625)scale(0.7)" xlink:href="#DejaVuSans-49"/>
     </g>
    </g>
   </g>
   <g id="text_9">
    <g clip-path="url(#pc4d39b6756)">
     <!-- 2 -->
     <defs>
      <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"/>
     </defs>
     <g transform="translate(67.926172 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-50"/>
     </g>
    </g>
   </g>
   <g id="text_10">
    <g clip-path="url(#pc4d39b6756)">
     <!-- c -->
     <defs>
      <path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"/>
     </defs>
     <g transform="translate(45.355911 138.946784)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-99"/>
     </g>
    </g>
   </g>
  </g>
 </g>
 <defs>
  <clipPath id="pc4d39b6756">
   <rect height="154.5334" width="292.526272" x="7.2" y="7.2"/>
  </clipPath>
 </defs>
</svg>

</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_chsh_circuits</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="168.9334pt" version="1.1" viewBox="0 0 306.926272 168.9334" width="306.926272pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <defs>
  <style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 168.9334 
L 306.926272 168.9334 
L 306.926272 0 
L 0 0 
z
" style="fill:#ffffff;"/>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path clip-path="url(#pe8926fd944)" d="M 172.917982 124.122697 
L 184.735242 124.122697 
L 178.826612 132.64476 
z
" style="fill:#778899;"/>
   </g>
   <g id="patch_3">
    <path clip-path="url(#pe8926fd944)" d="M 263.819982 124.122697 
L 275.637242 124.122697 
L 269.728612 132.64476 
z
" style="fill:#778899;"/>
   </g>
   <g id="line2d_1">
    <path clip-path="url(#pe8926fd944)" d="M 63.381072 43.5608 
L 295.181172 43.5608 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_2">
    <path clip-path="url(#pe8926fd944)" d="M 63.381072 89.0118 
L 295.181172 89.0118 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_3">
    <path clip-path="url(#pe8926fd944)" d="M 63.381072 132.985642 
L 295.181172 132.985642 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_4">
    <path clip-path="url(#pe8926fd944)" d="M 63.381072 135.939957 
L 295.181172 135.939957 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_5">
    <path clip-path="url(#pe8926fd944)" d="M 133.375612 89.0118 
L 133.375612 43.5608 
" style="fill:none;stroke:#6fa4ff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_6">
    <path clip-path="url(#pe8926fd944)" d="M 180.30377 89.0118 
L 180.30377 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_7">
    <path clip-path="url(#pe8926fd944)" d="M 177.349455 89.0118 
L 177.349455 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_8">
    <path clip-path="url(#pe8926fd944)" d="M 271.20577 43.5608 
L 271.20577 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_9">
    <path clip-path="url(#pe8926fd944)" d="M 268.251455 43.5608 
L 268.251455 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_10">
    <path clip-path="url(#pe8926fd944)" d="M 72.471272 139.0079 
L 77.016372 129.9177 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:1.5;"/>
   </g>
   <g id="patch_4">
    <path clip-path="url(#pe8926fd944)" d="M 73.153037 58.332375 
L 102.696187 58.332375 
L 102.696187 28.789225 
L 73.153037 28.789225 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_5">
    <path clip-path="url(#pe8926fd944)" d="M 133.375612 47.992272 
C 134.550852 47.992272 135.678116 47.525345 136.509136 46.694324 
C 137.340157 45.863304 137.807085 44.73604 137.807085 43.5608 
C 137.807085 42.38556 137.340157 41.258296 136.509136 40.427276 
C 135.678116 39.596255 134.550852 39.129327 133.375612 39.129327 
C 132.200372 39.129327 131.073108 39.596255 130.242088 40.427276 
C 129.411067 41.258296 128.94414 42.38556 128.94414 43.5608 
C 128.94414 44.73604 129.411067 45.863304 130.242088 46.694324 
C 131.073108 47.525345 132.200372 47.992272 133.375612 47.992272 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_6">
    <path clip-path="url(#pe8926fd944)" d="M 133.375612 99.351902 
C 136.117839 99.351902 138.748121 98.262404 140.687169 96.323357 
C 142.626216 94.384309 143.715715 91.754027 143.715715 89.0118 
C 143.715715 86.269573 142.626216 83.639291 140.687169 81.700243 
C 138.748121 79.761196 136.117839 78.671697 133.375612 78.671697 
C 130.633385 78.671697 128.003103 79.761196 126.064055 81.700243 
C 124.125008 83.639291 123.03551 86.269573 123.03551 89.0118 
C 123.03551 91.754027 124.125008 94.384309 126.064055 96.323357 
C 128.003103 98.262404 130.633385 99.351902 133.375612 99.351902 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="patch_7">
    <path clip-path="url(#pe8926fd944)" d="M 164.055037 58.332375 
L 193.598187 58.332375 
L 193.598187 28.789225 
L 164.055037 28.789225 
z
" style="fill:#bb8bff;stroke:#bb8bff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_8">
    <path clip-path="url(#pe8926fd944)" d="M 164.055037 103.783375 
L 193.598187 103.783375 
L 193.598187 74.240225 
L 164.055037 74.240225 
z
" style="stroke:#000000;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_9">
    <path clip-path="url(#pe8926fd944)" d="M 189.166715 93.443272 
C 189.166715 90.701959 188.07657 88.070118 186.138169 86.131716 
C 184.199767 84.193314 181.567926 83.10317 178.826612 83.10317 
C 176.085298 83.10317 173.453457 84.193314 171.515055 86.131716 
C 169.576654 88.070118 168.48651 90.701959 168.48651 93.443272 
" style="fill:none;stroke:#ffffff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="patch_10">
    <path clip-path="url(#pe8926fd944)" d="M 209.506037 58.332375 
L 239.049187 58.332375 
L 239.049187 28.789225 
L 209.506037 28.789225 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_11">
    <path clip-path="url(#pe8926fd944)" d="M 254.957037 58.332375 
L 284.500187 58.332375 
L 284.500187 28.789225 
L 254.957037 28.789225 
z
" style="stroke:#000000;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_12">
    <path clip-path="url(#pe8926fd944)" d="M 280.068715 47.992272 
C 280.068715 45.250959 278.97857 42.619118 277.040169 40.680716 
C 275.101767 38.742314 272.469926 37.65217 269.728612 37.65217 
C 266.987298 37.65217 264.355457 38.742314 262.417055 40.680716 
C 260.478654 42.619118 259.38851 45.250959 259.38851 47.992272 
" style="fill:none;stroke:#ffffff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="line2d_11">
    <path clip-path="url(#pe8926fd944)" d="M 178.826612 93.443272 
L 189.166715 83.10317 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_12">
    <path clip-path="url(#pe8926fd944)" d="M 269.728612 47.992272 
L 280.068715 37.65217 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_13">
    <path clip-path="url(#pe8926fd944)" d="M 133.375612 94.92043 
L 133.375612 83.10317 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_14">
    <path clip-path="url(#pe8926fd944)" d="M 127.466982 89.0118 
L 139.284242 89.0118 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="text_1">
    <g clip-path="url(#pe8926fd944)">
     <!-- H -->
     <defs>
      <path d="M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 43.015625 
L 55.515625 43.015625 
L 55.515625 72.90625 
L 65.375 72.90625 
L 65.375 0 
L 55.515625 0 
L 55.515625 34.71875 
L 19.671875 34.71875 
L 19.671875 0 
L 9.8125 0 
z
" id="DejaVuSans-72"/>
     </defs>
     <g transform="translate(83.036409 47.147987)scale(0.13 -0.13)">
      <use xlink:href="#DejaVuSans-72"/>
     </g>
    </g>
   </g>
   <g id="text_2">
    <g clip-path="url(#pe8926fd944)">
     <!-- $\mathrm{R}_\mathrm{Y}$ -->
     <defs>
      <path d="M 44.390625 34.1875 
Q 47.5625 33.109375 50.5625 29.59375 
Q 53.5625 26.078125 56.59375 19.921875 
L 66.609375 0 
L 56 0 
L 46.6875 18.703125 
Q 43.0625 26.03125 39.671875 28.421875 
Q 36.28125 30.8125 30.421875 30.8125 
L 19.671875 30.8125 
L 19.671875 0 
L 9.8125 0 
L 9.8125 72.90625 
L 32.078125 72.90625 
Q 44.578125 72.90625 50.734375 67.671875 
Q 56.890625 62.453125 56.890625 51.90625 
Q 56.890625 45.015625 53.6875 40.46875 
Q 50.484375 35.9375 44.390625 34.1875 
z
M 19.671875 64.796875 
L 19.671875 38.921875 
L 32.078125 38.921875 
Q 39.203125 38.921875 42.84375 42.21875 
Q 46.484375 45.515625 46.484375 51.90625 
Q 46.484375 58.296875 42.84375 61.546875 
Q 39.203125 64.796875 32.078125 64.796875 
z
" id="DejaVuSans-82"/>
      <path d="M -0.203125 72.90625 
L 10.40625 72.90625 
L 30.609375 42.921875 
L 50.6875 72.90625 
L 61.28125 72.90625 
L 35.5 34.71875 
L 35.5 0 
L 25.59375 0 
L 25.59375 34.71875 
z
" id="DejaVuSans-89"/>
     </defs>
     <g transform="translate(171.286612 42.716515)scale(0.13 -0.13)">
      <use transform="translate(0 0.09375)" xlink:href="#DejaVuSans-82"/>
      <use transform="translate(70.439453 -16.3125)scale(0.7)" xlink:href="#DejaVuSans-89"/>
     </g>
    </g>
   </g>
   <g id="text_3">
    <g clip-path="url(#pe8926fd944)">
     <!-- $\pi$/7 -->
     <defs>
      <path d="M 9.125 54.6875 
L 61.53125 54.6875 
L 59.765625 45.703125 
L 52.875 45.703125 
L 46.34375 12.109375 
Q 45.65625 8.59375 46.578125 7.03125 
Q 47.46875 5.515625 50.140625 5.515625 
Q 50.875 5.515625 51.953125 5.671875 
Q 53.078125 5.765625 53.421875 5.8125 
L 52.15625 -0.6875 
Q 50.34375 -1.3125 48.484375 -1.609375 
Q 46.578125 -1.90625 44.78125 -1.90625 
Q 38.921875 -1.90625 37.3125 1.265625 
Q 35.6875 4.5 37.359375 13.09375 
L 43.703125 45.703125 
L 23.53125 45.703125 
L 14.65625 0 
L 5.46875 0 
L 14.359375 45.703125 
L 7.375 45.703125 
z
" id="DejaVuSans-Oblique-960"/>
      <path d="M 25.390625 72.90625 
L 33.6875 72.90625 
L 8.296875 -9.28125 
L 0 -9.28125 
z
" id="DejaVuSans-47"/>
      <path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"/>
     </defs>
     <g transform="translate(173.066612 54.631245)scale(0.08 -0.08)">
      <use transform="translate(0 0.09375)" xlink:href="#DejaVuSans-Oblique-960"/>
      <use transform="translate(60.205078 0.09375)" xlink:href="#DejaVuSans-47"/>
      <use transform="translate(80.146484 0.09375)" xlink:href="#DejaVuSans-55"/>
     </g>
    </g>
   </g>
   <g id="text_4">
    <g clip-path="url(#pe8926fd944)">
     <!-- 1 -->
     <defs>
      <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"/>
     </defs>
     <g transform="translate(190.189362 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-49"/>
     </g>
    </g>
   </g>
   <g id="text_5">
    <g clip-path="url(#pe8926fd944)">
     <!-- H -->
     <g transform="translate(219.389409 47.147987)scale(0.13 -0.13)">
      <use xlink:href="#DejaVuSans-72"/>
     </g>
    </g>
   </g>
   <g id="text_6">
    <g clip-path="url(#pe8926fd944)">
     <!-- 0 -->
     <defs>
      <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"/>
     </defs>
     <g transform="translate(281.091362 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-48"/>
     </g>
    </g>
   </g>
   <g id="text_7">
    <g clip-path="url(#pe8926fd944)">
     <!-- ${q}_{0}$ -->
     <defs>
      <path d="M 41.703125 8.203125 
Q 38.09375 3.46875 33.171875 1.015625 
Q 28.265625 -1.421875 22.3125 -1.421875 
Q 14.015625 -1.421875 9.296875 4.171875 
Q 4.59375 9.765625 4.59375 19.578125 
Q 4.59375 27.484375 7.5 34.859375 
Q 10.40625 42.234375 15.828125 48.09375 
Q 19.34375 51.90625 23.90625 53.953125 
Q 28.46875 56 33.5 56 
Q 39.546875 56 43.453125 53.609375 
Q 47.359375 51.21875 49.125 46.390625 
L 50.6875 54.59375 
L 59.71875 54.59375 
L 45.125 -20.609375 
L 36.078125 -20.609375 
z
M 13.921875 20.90625 
Q 13.921875 13.671875 16.9375 9.890625 
Q 19.96875 6.109375 25.6875 6.109375 
Q 34.1875 6.109375 40.1875 14.234375 
Q 46.1875 22.359375 46.1875 33.984375 
Q 46.1875 41.015625 43.078125 44.75 
Q 39.984375 48.484375 34.1875 48.484375 
Q 29.9375 48.484375 26.3125 46.5 
Q 22.703125 44.53125 20.015625 40.71875 
Q 17.1875 36.71875 15.546875 31.34375 
Q 13.921875 25.984375 13.921875 20.90625 
z
" id="DejaVuSans-Oblique-113"/>
     </defs>
     <g transform="translate(36.253372 48.011777)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-Oblique-113"/>
      <use transform="translate(63.476562 -16.40625)scale(0.7)" xlink:href="#DejaVuSans-48"/>
     </g>
    </g>
   </g>
   <g id="text_8">
    <g clip-path="url(#pe8926fd944)">
     <!-- ${q}_{1}$ -->
     <g transform="translate(36.253372 93.462777)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-Oblique-113"/>
      <use transform="translate(63.476562 -16.40625)scale(0.7)" xlink:href="#DejaVuSans-49"/>
     </g>
    </g>
   </g>
   <g id="text_9">
    <g clip-path="url(#pe8926fd944)">
     <!-- 2 -->
     <defs>
      <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"/>
     </defs>
     <g transform="translate(67.926172 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-50"/>
     </g>
    </g>
   </g>
   <g id="text_10">
    <g clip-path="url(#pe8926fd944)">
     <!-- c -->
     <defs>
      <path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"/>
     </defs>
     <g transform="translate(45.355911 138.946784)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-99"/>
     </g>
    </g>
   </g>
  </g>
 </g>
 <defs>
  <clipPath id="pe8926fd944">
   <rect height="154.5334" width="292.526272" x="7.2" y="7.2"/>
  </clipPath>
 </defs>
</svg>

</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_chsh_circuits</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="168.9334pt" version="1.1" viewBox="0 0 306.926272 168.9334" width="306.926272pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <defs>
  <style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 168.9334 
L 306.926272 168.9334 
L 306.926272 0 
L 0 0 
z
" style="fill:#ffffff;"/>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path clip-path="url(#pfc0795420f)" d="M 218.368982 124.122697 
L 230.186242 124.122697 
L 224.277612 132.64476 
z
" style="fill:#778899;"/>
   </g>
   <g id="patch_3">
    <path clip-path="url(#pfc0795420f)" d="M 263.819982 124.122697 
L 275.637242 124.122697 
L 269.728612 132.64476 
z
" style="fill:#778899;"/>
   </g>
   <g id="line2d_1">
    <path clip-path="url(#pfc0795420f)" d="M 63.381072 43.5608 
L 295.181172 43.5608 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_2">
    <path clip-path="url(#pfc0795420f)" d="M 63.381072 89.0118 
L 295.181172 89.0118 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_3">
    <path clip-path="url(#pfc0795420f)" d="M 63.381072 132.985642 
L 295.181172 132.985642 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_4">
    <path clip-path="url(#pfc0795420f)" d="M 63.381072 135.939957 
L 295.181172 135.939957 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_5">
    <path clip-path="url(#pfc0795420f)" d="M 133.375612 89.0118 
L 133.375612 43.5608 
" style="fill:none;stroke:#6fa4ff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_6">
    <path clip-path="url(#pfc0795420f)" d="M 225.75477 89.0118 
L 225.75477 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_7">
    <path clip-path="url(#pfc0795420f)" d="M 222.800455 89.0118 
L 222.800455 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_8">
    <path clip-path="url(#pfc0795420f)" d="M 271.20577 43.5608 
L 271.20577 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_9">
    <path clip-path="url(#pfc0795420f)" d="M 268.251455 43.5608 
L 268.251455 124.122697 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_10">
    <path clip-path="url(#pfc0795420f)" d="M 72.471272 139.0079 
L 77.016372 129.9177 
" style="fill:none;stroke:#778899;stroke-linecap:square;stroke-width:1.5;"/>
   </g>
   <g id="patch_4">
    <path clip-path="url(#pfc0795420f)" d="M 73.153037 58.332375 
L 102.696187 58.332375 
L 102.696187 28.789225 
L 73.153037 28.789225 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_5">
    <path clip-path="url(#pfc0795420f)" d="M 133.375612 47.992272 
C 134.550852 47.992272 135.678116 47.525345 136.509136 46.694324 
C 137.340157 45.863304 137.807085 44.73604 137.807085 43.5608 
C 137.807085 42.38556 137.340157 41.258296 136.509136 40.427276 
C 135.678116 39.596255 134.550852 39.129327 133.375612 39.129327 
C 132.200372 39.129327 131.073108 39.596255 130.242088 40.427276 
C 129.411067 41.258296 128.94414 42.38556 128.94414 43.5608 
C 128.94414 44.73604 129.411067 45.863304 130.242088 46.694324 
C 131.073108 47.525345 132.200372 47.992272 133.375612 47.992272 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_6">
    <path clip-path="url(#pfc0795420f)" d="M 133.375612 99.351902 
C 136.117839 99.351902 138.748121 98.262404 140.687169 96.323357 
C 142.626216 94.384309 143.715715 91.754027 143.715715 89.0118 
C 143.715715 86.269573 142.626216 83.639291 140.687169 81.700243 
C 138.748121 79.761196 136.117839 78.671697 133.375612 78.671697 
C 130.633385 78.671697 128.003103 79.761196 126.064055 81.700243 
C 124.125008 83.639291 123.03551 86.269573 123.03551 89.0118 
C 123.03551 91.754027 124.125008 94.384309 126.064055 96.323357 
C 128.003103 98.262404 130.633385 99.351902 133.375612 99.351902 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="patch_7">
    <path clip-path="url(#pfc0795420f)" d="M 164.055037 58.332375 
L 193.598187 58.332375 
L 193.598187 28.789225 
L 164.055037 28.789225 
z
" style="fill:#bb8bff;stroke:#bb8bff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_8">
    <path clip-path="url(#pfc0795420f)" d="M 164.055037 103.783375 
L 193.598187 103.783375 
L 193.598187 74.240225 
L 164.055037 74.240225 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_9">
    <path clip-path="url(#pfc0795420f)" d="M 209.506037 58.332375 
L 239.049187 58.332375 
L 239.049187 28.789225 
L 209.506037 28.789225 
z
" style="fill:#6fa4ff;stroke:#6fa4ff;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_10">
    <path clip-path="url(#pfc0795420f)" d="M 209.506037 103.783375 
L 239.049187 103.783375 
L 239.049187 74.240225 
L 209.506037 74.240225 
z
" style="stroke:#000000;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_11">
    <path clip-path="url(#pfc0795420f)" d="M 234.617715 93.443272 
C 234.617715 90.701959 233.52757 88.070118 231.589169 86.131716 
C 229.650767 84.193314 227.018926 83.10317 224.277612 83.10317 
C 221.536298 83.10317 218.904457 84.193314 216.966055 86.131716 
C 215.027654 88.070118 213.93751 90.701959 213.93751 93.443272 
" style="fill:none;stroke:#ffffff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="patch_12">
    <path clip-path="url(#pfc0795420f)" d="M 254.957037 58.332375 
L 284.500187 58.332375 
L 284.500187 28.789225 
L 254.957037 28.789225 
z
" style="stroke:#000000;stroke-linejoin:miter;stroke-width:1.5;"/>
   </g>
   <g id="patch_13">
    <path clip-path="url(#pfc0795420f)" d="M 280.068715 47.992272 
C 280.068715 45.250959 278.97857 42.619118 277.040169 40.680716 
C 275.101767 38.742314 272.469926 37.65217 269.728612 37.65217 
C 266.987298 37.65217 264.355457 38.742314 262.417055 40.680716 
C 260.478654 42.619118 259.38851 45.250959 259.38851 47.992272 
" style="fill:none;stroke:#ffffff;stroke-linejoin:miter;stroke-width:2;"/>
   </g>
   <g id="line2d_11">
    <path clip-path="url(#pfc0795420f)" d="M 224.277612 93.443272 
L 234.617715 83.10317 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_12">
    <path clip-path="url(#pfc0795420f)" d="M 269.728612 47.992272 
L 280.068715 37.65217 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_13">
    <path clip-path="url(#pfc0795420f)" d="M 133.375612 94.92043 
L 133.375612 83.10317 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="line2d_14">
    <path clip-path="url(#pfc0795420f)" d="M 127.466982 89.0118 
L 139.284242 89.0118 
" style="fill:none;stroke:#ffffff;stroke-linecap:square;stroke-width:2;"/>
   </g>
   <g id="text_1">
    <g clip-path="url(#pfc0795420f)">
     <!-- H -->
     <defs>
      <path d="M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 43.015625 
L 55.515625 43.015625 
L 55.515625 72.90625 
L 65.375 72.90625 
L 65.375 0 
L 55.515625 0 
L 55.515625 34.71875 
L 19.671875 34.71875 
L 19.671875 0 
L 9.8125 0 
z
" id="DejaVuSans-72"/>
     </defs>
     <g transform="translate(83.036409 47.147987)scale(0.13 -0.13)">
      <use xlink:href="#DejaVuSans-72"/>
     </g>
    </g>
   </g>
   <g id="text_2">
    <g clip-path="url(#pfc0795420f)">
     <!-- $\mathrm{R}_\mathrm{Y}$ -->
     <defs>
      <path d="M 44.390625 34.1875 
Q 47.5625 33.109375 50.5625 29.59375 
Q 53.5625 26.078125 56.59375 19.921875 
L 66.609375 0 
L 56 0 
L 46.6875 18.703125 
Q 43.0625 26.03125 39.671875 28.421875 
Q 36.28125 30.8125 30.421875 30.8125 
L 19.671875 30.8125 
L 19.671875 0 
L 9.8125 0 
L 9.8125 72.90625 
L 32.078125 72.90625 
Q 44.578125 72.90625 50.734375 67.671875 
Q 56.890625 62.453125 56.890625 51.90625 
Q 56.890625 45.015625 53.6875 40.46875 
Q 50.484375 35.9375 44.390625 34.1875 
z
M 19.671875 64.796875 
L 19.671875 38.921875 
L 32.078125 38.921875 
Q 39.203125 38.921875 42.84375 42.21875 
Q 46.484375 45.515625 46.484375 51.90625 
Q 46.484375 58.296875 42.84375 61.546875 
Q 39.203125 64.796875 32.078125 64.796875 
z
" id="DejaVuSans-82"/>
      <path d="M -0.203125 72.90625 
L 10.40625 72.90625 
L 30.609375 42.921875 
L 50.6875 72.90625 
L 61.28125 72.90625 
L 35.5 34.71875 
L 35.5 0 
L 25.59375 0 
L 25.59375 34.71875 
z
" id="DejaVuSans-89"/>
     </defs>
     <g transform="translate(171.286612 42.716515)scale(0.13 -0.13)">
      <use transform="translate(0 0.09375)" xlink:href="#DejaVuSans-82"/>
      <use transform="translate(70.439453 -16.3125)scale(0.7)" xlink:href="#DejaVuSans-89"/>
     </g>
    </g>
   </g>
   <g id="text_3">
    <g clip-path="url(#pfc0795420f)">
     <!-- $\pi$/7 -->
     <defs>
      <path d="M 9.125 54.6875 
L 61.53125 54.6875 
L 59.765625 45.703125 
L 52.875 45.703125 
L 46.34375 12.109375 
Q 45.65625 8.59375 46.578125 7.03125 
Q 47.46875 5.515625 50.140625 5.515625 
Q 50.875 5.515625 51.953125 5.671875 
Q 53.078125 5.765625 53.421875 5.8125 
L 52.15625 -0.6875 
Q 50.34375 -1.3125 48.484375 -1.609375 
Q 46.578125 -1.90625 44.78125 -1.90625 
Q 38.921875 -1.90625 37.3125 1.265625 
Q 35.6875 4.5 37.359375 13.09375 
L 43.703125 45.703125 
L 23.53125 45.703125 
L 14.65625 0 
L 5.46875 0 
L 14.359375 45.703125 
L 7.375 45.703125 
z
" id="DejaVuSans-Oblique-960"/>
      <path d="M 25.390625 72.90625 
L 33.6875 72.90625 
L 8.296875 -9.28125 
L 0 -9.28125 
z
" id="DejaVuSans-47"/>
      <path d="M 8.203125 72.90625 
L 55.078125 72.90625 
L 55.078125 68.703125 
L 28.609375 0 
L 18.3125 0 
L 43.21875 64.59375 
L 8.203125 64.59375 
z
" id="DejaVuSans-55"/>
     </defs>
     <g transform="translate(173.066612 54.631245)scale(0.08 -0.08)">
      <use transform="translate(0 0.09375)" xlink:href="#DejaVuSans-Oblique-960"/>
      <use transform="translate(60.205078 0.09375)" xlink:href="#DejaVuSans-47"/>
      <use transform="translate(80.146484 0.09375)" xlink:href="#DejaVuSans-55"/>
     </g>
    </g>
   </g>
   <g id="text_4">
    <g clip-path="url(#pfc0795420f)">
     <!-- H -->
     <g transform="translate(173.938409 92.598987)scale(0.13 -0.13)">
      <use xlink:href="#DejaVuSans-72"/>
     </g>
    </g>
   </g>
   <g id="text_5">
    <g clip-path="url(#pfc0795420f)">
     <!-- H -->
     <g transform="translate(219.389409 47.147987)scale(0.13 -0.13)">
      <use xlink:href="#DejaVuSans-72"/>
     </g>
    </g>
   </g>
   <g id="text_6">
    <g clip-path="url(#pfc0795420f)">
     <!-- 1 -->
     <defs>
      <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"/>
     </defs>
     <g transform="translate(235.640362 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-49"/>
     </g>
    </g>
   </g>
   <g id="text_7">
    <g clip-path="url(#pfc0795420f)">
     <!-- 0 -->
     <defs>
      <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"/>
     </defs>
     <g transform="translate(281.091362 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-48"/>
     </g>
    </g>
   </g>
   <g id="text_8">
    <g clip-path="url(#pfc0795420f)">
     <!-- ${q}_{0}$ -->
     <defs>
      <path d="M 41.703125 8.203125 
Q 38.09375 3.46875 33.171875 1.015625 
Q 28.265625 -1.421875 22.3125 -1.421875 
Q 14.015625 -1.421875 9.296875 4.171875 
Q 4.59375 9.765625 4.59375 19.578125 
Q 4.59375 27.484375 7.5 34.859375 
Q 10.40625 42.234375 15.828125 48.09375 
Q 19.34375 51.90625 23.90625 53.953125 
Q 28.46875 56 33.5 56 
Q 39.546875 56 43.453125 53.609375 
Q 47.359375 51.21875 49.125 46.390625 
L 50.6875 54.59375 
L 59.71875 54.59375 
L 45.125 -20.609375 
L 36.078125 -20.609375 
z
M 13.921875 20.90625 
Q 13.921875 13.671875 16.9375 9.890625 
Q 19.96875 6.109375 25.6875 6.109375 
Q 34.1875 6.109375 40.1875 14.234375 
Q 46.1875 22.359375 46.1875 33.984375 
Q 46.1875 41.015625 43.078125 44.75 
Q 39.984375 48.484375 34.1875 48.484375 
Q 29.9375 48.484375 26.3125 46.5 
Q 22.703125 44.53125 20.015625 40.71875 
Q 17.1875 36.71875 15.546875 31.34375 
Q 13.921875 25.984375 13.921875 20.90625 
z
" id="DejaVuSans-Oblique-113"/>
     </defs>
     <g transform="translate(36.253372 48.011777)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-Oblique-113"/>
      <use transform="translate(63.476562 -16.40625)scale(0.7)" xlink:href="#DejaVuSans-48"/>
     </g>
    </g>
   </g>
   <g id="text_9">
    <g clip-path="url(#pfc0795420f)">
     <!-- ${q}_{1}$ -->
     <g transform="translate(36.253372 93.462777)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-Oblique-113"/>
      <use transform="translate(63.476562 -16.40625)scale(0.7)" xlink:href="#DejaVuSans-49"/>
     </g>
    </g>
   </g>
   <g id="text_10">
    <g clip-path="url(#pfc0795420f)">
     <!-- 2 -->
     <defs>
      <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"/>
     </defs>
     <g transform="translate(67.926172 127.754825)scale(0.104 -0.104)">
      <use xlink:href="#DejaVuSans-50"/>
     </g>
    </g>
   </g>
   <g id="text_11">
    <g clip-path="url(#pfc0795420f)">
     <!-- c -->
     <defs>
      <path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"/>
     </defs>
     <g transform="translate(45.355911 138.946784)scale(0.1625 -0.1625)">
      <use xlink:href="#DejaVuSans-99"/>
     </g>
    </g>
   </g>
  </g>
 </g>
 <defs>
  <clipPath id="pfc0795420f">
   <rect height="154.5334" width="292.526272" x="7.2" y="7.2"/>
  </clipPath>
 </defs>
</svg>

</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These circuits are simply creating a Bell pair, and then measuring each party in a different basis. While Bob ($q_1$) always measures either in the computational basis or the $X$ basis, Alice's measurement basis rotates by the angle $\theta$ with respect to Bob's.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_uses-hardware">

<div class="cell border-box-sizing code_cell rendered tag_uses-hardware">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Execute and get counts</span>
<span class="n">result_ideal</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">my_chsh_circuits</span><span class="p">,</span> <span class="n">qasm_sim</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>

<span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">job_real</span> <span class="o">=</span> <span class="n">execute</span><span class="p">(</span><span class="n">my_chsh_circuits</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">lima</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">8192</span><span class="p">)</span>
<span class="n">job_monitor</span><span class="p">(</span><span class="n">job_real</span><span class="p">)</span>
<span class="n">result_real</span> <span class="o">=</span> <span class="n">job_real</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="n">toc</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">toc</span><span class="o">-</span><span class="n">tic</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Job Status: job has successfully run
7.394834041595459
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell tag_uses-hardware">

<div class="cell border-box-sizing code_cell rendered tag_uses-hardware">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">CHSH1_ideal</span><span class="p">,</span> <span class="n">CHSH2_ideal</span> <span class="o">=</span> <span class="n">compute_chsh_witness</span><span class="p">(</span><span class="n">result_ideal</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>
<span class="n">CHSH1_real</span><span class="p">,</span> <span class="n">CHSH2_real</span> <span class="o">=</span> <span class="n">compute_chsh_witness</span><span class="p">(</span><span class="n">result_real</span><span class="o">.</span><span class="n">get_counts</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we plot the results</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_uses-hardware">

<div class="cell border-box-sizing code_cell rendered tag_uses-hardware">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_vec</span><span class="p">,</span><span class="n">CHSH1_ideal</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CHSH1 Noiseless&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_vec</span><span class="p">,</span><span class="n">CHSH2_ideal</span><span class="p">,</span><span class="s1">&#39;o-&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CHSH2 Noiseless&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_vec</span><span class="p">,</span><span class="n">CHSH1_real</span><span class="p">,</span><span class="s1">&#39;x-&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CHSH1 Lima&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta_vec</span><span class="p">,</span><span class="n">CHSH2_real</span><span class="p">,</span><span class="s1">&#39;x-&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CHSH2 Lima&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Theta&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;CHSH witness&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;CHSH witness&#39;)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="502.86375pt" version="1.1" viewBox="0 0 748.724687 502.86375" width="748.724687pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <defs>
  <style type="text/css">
*{stroke-linecap:butt;stroke-linejoin:round;}
  </style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 502.86375 
L 748.724687 502.86375 
L 748.724687 0 
L 0 0 
z
" style="fill:none;"/>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 71.924688 442.08 
L 741.524688 442.08 
L 741.524688 7.2 
L 71.924688 7.2 
z
" style="fill:#ffffff;"/>
   </g>
   <g id="matplotlib.axis_1">
    <g id="xtick_1">
     <g id="line2d_1">
      <path clip-path="url(#p166b506543)" d="M 102.361051 442.08 
L 102.361051 7.2 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_2">
      <defs>
       <path d="M 0 0 
L 0 3.5 
" id="m1ac7cb3a03" style="stroke:#000000;stroke-width:0.8;"/>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="102.361051" xlink:href="#m1ac7cb3a03" y="442.08"/>
      </g>
     </g>
     <g id="text_1">
      <!-- 0 -->
      <defs>
       <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"/>
      </defs>
      <g transform="translate(95.362301 465.796562)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="xtick_2">
     <g id="line2d_3">
      <path clip-path="url(#p166b506543)" d="M 199.243006 442.08 
L 199.243006 7.2 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_4">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="199.243006" xlink:href="#m1ac7cb3a03" y="442.08"/>
      </g>
     </g>
     <g id="text_2">
      <!-- 1 -->
      <defs>
       <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"/>
      </defs>
      <g transform="translate(192.244256 465.796562)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-49"/>
      </g>
     </g>
    </g>
    <g id="xtick_3">
     <g id="line2d_5">
      <path clip-path="url(#p166b506543)" d="M 296.12496 442.08 
L 296.12496 7.2 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_6">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="296.12496" xlink:href="#m1ac7cb3a03" y="442.08"/>
      </g>
     </g>
     <g id="text_3">
      <!-- 2 -->
      <defs>
       <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"/>
      </defs>
      <g transform="translate(289.12621 465.796562)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-50"/>
      </g>
     </g>
    </g>
    <g id="xtick_4">
     <g id="line2d_7">
      <path clip-path="url(#p166b506543)" d="M 393.006914 442.08 
L 393.006914 7.2 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_8">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="393.006914" xlink:href="#m1ac7cb3a03" y="442.08"/>
      </g>
     </g>
     <g id="text_4">
      <!-- 3 -->
      <defs>
       <path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"/>
      </defs>
      <g transform="translate(386.008164 465.796562)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-51"/>
      </g>
     </g>
    </g>
    <g id="xtick_5">
     <g id="line2d_9">
      <path clip-path="url(#p166b506543)" d="M 489.888869 442.08 
L 489.888869 7.2 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_10">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="489.888869" xlink:href="#m1ac7cb3a03" y="442.08"/>
      </g>
     </g>
     <g id="text_5">
      <!-- 4 -->
      <defs>
       <path d="M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
" id="DejaVuSans-52"/>
      </defs>
      <g transform="translate(482.890119 465.796562)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-52"/>
      </g>
     </g>
    </g>
    <g id="xtick_6">
     <g id="line2d_11">
      <path clip-path="url(#p166b506543)" d="M 586.770823 442.08 
L 586.770823 7.2 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_12">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="586.770823" xlink:href="#m1ac7cb3a03" y="442.08"/>
      </g>
     </g>
     <g id="text_6">
      <!-- 5 -->
      <defs>
       <path d="M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
" id="DejaVuSans-53"/>
      </defs>
      <g transform="translate(579.772073 465.796562)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-53"/>
      </g>
     </g>
    </g>
    <g id="xtick_7">
     <g id="line2d_13">
      <path clip-path="url(#p166b506543)" d="M 683.652778 442.08 
L 683.652778 7.2 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_14">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="683.652778" xlink:href="#m1ac7cb3a03" y="442.08"/>
      </g>
     </g>
     <g id="text_7">
      <!-- 6 -->
      <defs>
       <path d="M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
" id="DejaVuSans-54"/>
      </defs>
      <g transform="translate(676.654028 465.796562)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-54"/>
      </g>
     </g>
    </g>
    <g id="text_8">
     <!-- Theta -->
     <defs>
      <path d="M -0.296875 72.90625 
L 61.375 72.90625 
L 61.375 64.59375 
L 35.5 64.59375 
L 35.5 0 
L 25.59375 0 
L 25.59375 64.59375 
L -0.296875 64.59375 
z
" id="DejaVuSans-84"/>
      <path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-104"/>
      <path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"/>
      <path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"/>
      <path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"/>
     </defs>
     <g transform="translate(375.213125 491.088437)scale(0.22 -0.22)">
      <use xlink:href="#DejaVuSans-84"/>
      <use x="61.083984" xlink:href="#DejaVuSans-104"/>
      <use x="124.462891" xlink:href="#DejaVuSans-101"/>
      <use x="185.986328" xlink:href="#DejaVuSans-116"/>
      <use x="225.195312" xlink:href="#DejaVuSans-97"/>
     </g>
    </g>
   </g>
   <g id="matplotlib.axis_2">
    <g id="ytick_1">
     <g id="line2d_15">
      <path clip-path="url(#p166b506543)" d="M 71.924688 432.152556 
L 741.524688 432.152556 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_16">
      <defs>
       <path d="M 0 0 
L -3.5 0 
" id="mc6e627ede1" style="stroke:#000000;stroke-width:0.8;"/>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="71.924688" xlink:href="#mc6e627ede1" y="432.152556"/>
      </g>
     </g>
     <g id="text_9">
      <!-- −3 -->
      <defs>
       <path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"/>
      </defs>
      <g transform="translate(32.491875 440.510837)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-8722"/>
       <use x="83.789062" xlink:href="#DejaVuSans-51"/>
      </g>
     </g>
    </g>
    <g id="ytick_2">
     <g id="line2d_17">
      <path clip-path="url(#p166b506543)" d="M 71.924688 363.138962 
L 741.524688 363.138962 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_18">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="71.924688" xlink:href="#mc6e627ede1" y="363.138962"/>
      </g>
     </g>
     <g id="text_10">
      <!-- −2 -->
      <g transform="translate(32.491875 371.497243)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-8722"/>
       <use x="83.789062" xlink:href="#DejaVuSans-50"/>
      </g>
     </g>
    </g>
    <g id="ytick_3">
     <g id="line2d_19">
      <path clip-path="url(#p166b506543)" d="M 71.924688 294.125367 
L 741.524688 294.125367 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_20">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="71.924688" xlink:href="#mc6e627ede1" y="294.125367"/>
      </g>
     </g>
     <g id="text_11">
      <!-- −1 -->
      <g transform="translate(32.491875 302.483648)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-8722"/>
       <use x="83.789062" xlink:href="#DejaVuSans-49"/>
      </g>
     </g>
    </g>
    <g id="ytick_4">
     <g id="line2d_21">
      <path clip-path="url(#p166b506543)" d="M 71.924688 225.111773 
L 741.524688 225.111773 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_22">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="71.924688" xlink:href="#mc6e627ede1" y="225.111773"/>
      </g>
     </g>
     <g id="text_12">
      <!-- 0 -->
      <g transform="translate(50.927188 233.470054)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-48"/>
      </g>
     </g>
    </g>
    <g id="ytick_5">
     <g id="line2d_23">
      <path clip-path="url(#p166b506543)" d="M 71.924688 156.098178 
L 741.524688 156.098178 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_24">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="71.924688" xlink:href="#mc6e627ede1" y="156.098178"/>
      </g>
     </g>
     <g id="text_13">
      <!-- 1 -->
      <g transform="translate(50.927188 164.456459)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-49"/>
      </g>
     </g>
    </g>
    <g id="ytick_6">
     <g id="line2d_25">
      <path clip-path="url(#p166b506543)" d="M 71.924688 87.084584 
L 741.524688 87.084584 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_26">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="71.924688" xlink:href="#mc6e627ede1" y="87.084584"/>
      </g>
     </g>
     <g id="text_14">
      <!-- 2 -->
      <g transform="translate(50.927188 95.442865)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-50"/>
      </g>
     </g>
    </g>
    <g id="ytick_7">
     <g id="line2d_27">
      <path clip-path="url(#p166b506543)" d="M 71.924688 18.070989 
L 741.524688 18.070989 
" style="fill:none;stroke:#b0b0b0;stroke-linecap:square;stroke-width:0.8;"/>
     </g>
     <g id="line2d_28">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="71.924688" xlink:href="#mc6e627ede1" y="18.070989"/>
      </g>
     </g>
     <g id="text_15">
      <!-- 3 -->
      <g transform="translate(50.927188 26.42927)scale(0.22 -0.22)">
       <use xlink:href="#DejaVuSans-51"/>
      </g>
     </g>
    </g>
    <g id="text_16">
     <!-- CHSH witness -->
     <defs>
      <path d="M 64.40625 67.28125 
L 64.40625 56.890625 
Q 59.421875 61.53125 53.78125 63.8125 
Q 48.140625 66.109375 41.796875 66.109375 
Q 29.296875 66.109375 22.65625 58.46875 
Q 16.015625 50.828125 16.015625 36.375 
Q 16.015625 21.96875 22.65625 14.328125 
Q 29.296875 6.6875 41.796875 6.6875 
Q 48.140625 6.6875 53.78125 8.984375 
Q 59.421875 11.28125 64.40625 15.921875 
L 64.40625 5.609375 
Q 59.234375 2.09375 53.4375 0.328125 
Q 47.65625 -1.421875 41.21875 -1.421875 
Q 24.65625 -1.421875 15.125 8.703125 
Q 5.609375 18.84375 5.609375 36.375 
Q 5.609375 53.953125 15.125 64.078125 
Q 24.65625 74.21875 41.21875 74.21875 
Q 47.75 74.21875 53.53125 72.484375 
Q 59.328125 70.75 64.40625 67.28125 
z
" id="DejaVuSans-67"/>
      <path d="M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 43.015625 
L 55.515625 43.015625 
L 55.515625 72.90625 
L 65.375 72.90625 
L 65.375 0 
L 55.515625 0 
L 55.515625 34.71875 
L 19.671875 34.71875 
L 19.671875 0 
L 9.8125 0 
z
" id="DejaVuSans-72"/>
      <path d="M 53.515625 70.515625 
L 53.515625 60.890625 
Q 47.90625 63.578125 42.921875 64.890625 
Q 37.9375 66.21875 33.296875 66.21875 
Q 25.25 66.21875 20.875 63.09375 
Q 16.5 59.96875 16.5 54.203125 
Q 16.5 49.359375 19.40625 46.890625 
Q 22.3125 44.4375 30.421875 42.921875 
L 36.375 41.703125 
Q 47.40625 39.59375 52.65625 34.296875 
Q 57.90625 29 57.90625 20.125 
Q 57.90625 9.515625 50.796875 4.046875 
Q 43.703125 -1.421875 29.984375 -1.421875 
Q 24.8125 -1.421875 18.96875 -0.25 
Q 13.140625 0.921875 6.890625 3.21875 
L 6.890625 13.375 
Q 12.890625 10.015625 18.65625 8.296875 
Q 24.421875 6.59375 29.984375 6.59375 
Q 38.421875 6.59375 43.015625 9.90625 
Q 47.609375 13.234375 47.609375 19.390625 
Q 47.609375 24.75 44.3125 27.78125 
Q 41.015625 30.8125 33.5 32.328125 
L 27.484375 33.5 
Q 16.453125 35.6875 11.515625 40.375 
Q 6.59375 45.0625 6.59375 53.421875 
Q 6.59375 63.09375 13.40625 68.65625 
Q 20.21875 74.21875 32.171875 74.21875 
Q 37.3125 74.21875 42.625 73.28125 
Q 47.953125 72.359375 53.515625 70.515625 
z
" id="DejaVuSans-83"/>
      <path id="DejaVuSans-32"/>
      <path d="M 4.203125 54.6875 
L 13.1875 54.6875 
L 24.421875 12.015625 
L 35.59375 54.6875 
L 46.1875 54.6875 
L 57.421875 12.015625 
L 68.609375 54.6875 
L 77.59375 54.6875 
L 63.28125 0 
L 52.6875 0 
L 40.921875 44.828125 
L 29.109375 0 
L 18.5 0 
z
" id="DejaVuSans-119"/>
      <path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"/>
      <path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"/>
      <path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"/>
     </defs>
     <g transform="translate(23.916563 300.909531)rotate(-90)scale(0.22 -0.22)">
      <use xlink:href="#DejaVuSans-67"/>
      <use x="69.824219" xlink:href="#DejaVuSans-72"/>
      <use x="145.019531" xlink:href="#DejaVuSans-83"/>
      <use x="208.496094" xlink:href="#DejaVuSans-72"/>
      <use x="283.691406" xlink:href="#DejaVuSans-32"/>
      <use x="315.478516" xlink:href="#DejaVuSans-119"/>
      <use x="397.265625" xlink:href="#DejaVuSans-105"/>
      <use x="425.048828" xlink:href="#DejaVuSans-116"/>
      <use x="464.257812" xlink:href="#DejaVuSans-110"/>
      <use x="527.636719" xlink:href="#DejaVuSans-101"/>
      <use x="589.160156" xlink:href="#DejaVuSans-115"/>
      <use x="641.259766" xlink:href="#DejaVuSans-115"/>
     </g>
    </g>
   </g>
   <g id="line2d_29">
    <path clip-path="url(#p166b506543)" d="M 102.361051 88.836882 
L 145.841571 154.076295 
L 189.32209 243.713093 
L 232.80261 327.823411 
L 276.283129 387.671138 
L 319.763649 412.607691 
L 363.244168 411.664145 
L 406.724688 363.947715 
L 450.205207 289.542433 
L 493.685726 202.871063 
L 537.166246 129.544119 
L 580.646765 57.969473 
L 624.127285 27.371649 
L 667.607804 44.75984 
L 711.088324 86.006246 
" style="fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;"/>
    <defs>
     <path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="mfd431abc88" style="stroke:#1f77b4;"/>
    </defs>
    <g clip-path="url(#p166b506543)">
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="102.361051" xlink:href="#mfd431abc88" y="88.836882"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="145.841571" xlink:href="#mfd431abc88" y="154.076295"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="189.32209" xlink:href="#mfd431abc88" y="243.713093"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="232.80261" xlink:href="#mfd431abc88" y="327.823411"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="276.283129" xlink:href="#mfd431abc88" y="387.671138"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="319.763649" xlink:href="#mfd431abc88" y="412.607691"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="363.244168" xlink:href="#mfd431abc88" y="411.664145"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="406.724688" xlink:href="#mfd431abc88" y="363.947715"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="450.205207" xlink:href="#mfd431abc88" y="289.542433"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="493.685726" xlink:href="#mfd431abc88" y="202.871063"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="537.166246" xlink:href="#mfd431abc88" y="129.544119"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="580.646765" xlink:href="#mfd431abc88" y="57.969473"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="624.127285" xlink:href="#mfd431abc88" y="27.371649"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="667.607804" xlink:href="#mfd431abc88" y="44.75984"/>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="711.088324" xlink:href="#mfd431abc88" y="86.006246"/>
    </g>
   </g>
   <g id="line2d_30">
    <path clip-path="url(#p166b506543)" d="M 102.361051 85.332285 
L 145.841571 48.668813 
L 189.32209 26.967273 
L 232.80261 58.508642 
L 276.283129 118.356369 
L 319.763649 199.366467 
L 363.244168 284.42033 
L 406.724688 362.330209 
L 450.205207 408.698717 
L 493.685726 422.312727 
L 537.166246 397.241382 
L 580.646765 328.092996 
L 624.127285 247.622066 
L 667.607804 158.524437 
L 711.088324 88.162921 
" style="fill:none;stroke:#ff7f0e;stroke-linecap:square;stroke-width:1.5;"/>
    <defs>
     <path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m0c5bcfc2d6" style="stroke:#ff7f0e;"/>
    </defs>
    <g clip-path="url(#p166b506543)">
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="102.361051" xlink:href="#m0c5bcfc2d6" y="85.332285"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="145.841571" xlink:href="#m0c5bcfc2d6" y="48.668813"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="189.32209" xlink:href="#m0c5bcfc2d6" y="26.967273"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="232.80261" xlink:href="#m0c5bcfc2d6" y="58.508642"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="276.283129" xlink:href="#m0c5bcfc2d6" y="118.356369"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="319.763649" xlink:href="#m0c5bcfc2d6" y="199.366467"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="363.244168" xlink:href="#m0c5bcfc2d6" y="284.42033"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="406.724688" xlink:href="#m0c5bcfc2d6" y="362.330209"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="450.205207" xlink:href="#m0c5bcfc2d6" y="408.698717"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="493.685726" xlink:href="#m0c5bcfc2d6" y="422.312727"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="537.166246" xlink:href="#m0c5bcfc2d6" y="397.241382"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="580.646765" xlink:href="#m0c5bcfc2d6" y="328.092996"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="624.127285" xlink:href="#m0c5bcfc2d6" y="247.622066"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="667.607804" xlink:href="#m0c5bcfc2d6" y="158.524437"/>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="711.088324" xlink:href="#m0c5bcfc2d6" y="88.162921"/>
    </g>
   </g>
   <g id="line2d_31">
    <path clip-path="url(#p166b506543)" d="M 102.361051 97.901656 
L 145.841571 165.297744 
L 189.32209 243.494056 
L 232.80261 319.567391 
L 276.283129 377.730215 
L 319.763649 403.290181 
L 363.244168 393.349258 
L 406.724688 352.288191 
L 450.205207 283.830615 
L 493.685726 204.269532 
L 537.166246 128.280443 
L 580.646765 72.055256 
L 624.127285 47.607325 
L 667.607804 56.486759 
L 711.088324 98.912597 
" style="fill:none;stroke:#2ca02c;stroke-linecap:square;stroke-width:1.5;"/>
    <defs>
     <path d="M -3 3 
L 3 -3 
M -3 -3 
L 3 3 
" id="m7220c03c23" style="stroke:#2ca02c;"/>
    </defs>
    <g clip-path="url(#p166b506543)">
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="102.361051" xlink:href="#m7220c03c23" y="97.901656"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="145.841571" xlink:href="#m7220c03c23" y="165.297744"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="189.32209" xlink:href="#m7220c03c23" y="243.494056"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="232.80261" xlink:href="#m7220c03c23" y="319.567391"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="276.283129" xlink:href="#m7220c03c23" y="377.730215"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="319.763649" xlink:href="#m7220c03c23" y="403.290181"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="363.244168" xlink:href="#m7220c03c23" y="393.349258"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="406.724688" xlink:href="#m7220c03c23" y="352.288191"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="450.205207" xlink:href="#m7220c03c23" y="283.830615"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="493.685726" xlink:href="#m7220c03c23" y="204.269532"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="537.166246" xlink:href="#m7220c03c23" y="128.280443"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="580.646765" xlink:href="#m7220c03c23" y="72.055256"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="624.127285" xlink:href="#m7220c03c23" y="47.607325"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="667.607804" xlink:href="#m7220c03c23" y="56.486759"/>
     <use style="fill:#2ca02c;stroke:#2ca02c;" x="711.088324" xlink:href="#m7220c03c23" y="98.912597"/>
    </g>
   </g>
   <g id="line2d_32">
    <path clip-path="url(#p166b506543)" d="M 102.361051 99.182181 
L 145.841571 55.745402 
L 189.32209 49.696604 
L 232.80261 72.49333 
L 276.283129 130.420268 
L 319.763649 207.201262 
L 363.244168 283.931709 
L 406.724688 352.759964 
L 450.205207 394.562388 
L 493.685726 402.885805 
L 537.166246 376.09586 
L 580.646765 320.44354 
L 624.127285 243.696244 
L 667.607804 166.274987 
L 711.088324 96.755922 
" style="fill:none;stroke:#d62728;stroke-linecap:square;stroke-width:1.5;"/>
    <defs>
     <path d="M -3 3 
L 3 -3 
M -3 -3 
L 3 3 
" id="ma6884bf940" style="stroke:#d62728;"/>
    </defs>
    <g clip-path="url(#p166b506543)">
     <use style="fill:#d62728;stroke:#d62728;" x="102.361051" xlink:href="#ma6884bf940" y="99.182181"/>
     <use style="fill:#d62728;stroke:#d62728;" x="145.841571" xlink:href="#ma6884bf940" y="55.745402"/>
     <use style="fill:#d62728;stroke:#d62728;" x="189.32209" xlink:href="#ma6884bf940" y="49.696604"/>
     <use style="fill:#d62728;stroke:#d62728;" x="232.80261" xlink:href="#ma6884bf940" y="72.49333"/>
     <use style="fill:#d62728;stroke:#d62728;" x="276.283129" xlink:href="#ma6884bf940" y="130.420268"/>
     <use style="fill:#d62728;stroke:#d62728;" x="319.763649" xlink:href="#ma6884bf940" y="207.201262"/>
     <use style="fill:#d62728;stroke:#d62728;" x="363.244168" xlink:href="#ma6884bf940" y="283.931709"/>
     <use style="fill:#d62728;stroke:#d62728;" x="406.724688" xlink:href="#ma6884bf940" y="352.759964"/>
     <use style="fill:#d62728;stroke:#d62728;" x="450.205207" xlink:href="#ma6884bf940" y="394.562388"/>
     <use style="fill:#d62728;stroke:#d62728;" x="493.685726" xlink:href="#ma6884bf940" y="402.885805"/>
     <use style="fill:#d62728;stroke:#d62728;" x="537.166246" xlink:href="#ma6884bf940" y="376.09586"/>
     <use style="fill:#d62728;stroke:#d62728;" x="580.646765" xlink:href="#ma6884bf940" y="320.44354"/>
     <use style="fill:#d62728;stroke:#d62728;" x="624.127285" xlink:href="#ma6884bf940" y="243.696244"/>
     <use style="fill:#d62728;stroke:#d62728;" x="667.607804" xlink:href="#ma6884bf940" y="166.274987"/>
     <use style="fill:#d62728;stroke:#d62728;" x="711.088324" xlink:href="#ma6884bf940" y="96.755922"/>
    </g>
   </g>
   <g id="line2d_33">
    <path clip-path="url(#p166b506543)" d="M 71.924688 87.084584 
L 741.524688 87.084584 
" style="fill:none;stroke:#ff0000;stroke-linecap:square;stroke-width:1.5;"/>
   </g>
   <g id="line2d_34">
    <path clip-path="url(#p166b506543)" d="M 71.924688 363.138962 
L 741.524688 363.138962 
" style="fill:none;stroke:#ff0000;stroke-linecap:square;stroke-width:1.5;"/>
   </g>
   <g id="line2d_35">
    <path clip-path="url(#p166b506543)" d="M 71.924688 29.91185 
L 741.524688 29.91185 
" style="fill:none;stroke:#000000;stroke-dasharray:9.6,2.4,1.5,2.4;stroke-dashoffset:0;stroke-width:1.5;"/>
   </g>
   <g id="line2d_36">
    <path clip-path="url(#p166b506543)" d="M 71.924688 420.311695 
L 741.524688 420.311695 
" style="fill:none;stroke:#000000;stroke-dasharray:9.6,2.4,1.5,2.4;stroke-dashoffset:0;stroke-width:1.5;"/>
   </g>
   <g id="patch_3">
    <path d="M 71.924688 442.08 
L 71.924688 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="patch_4">
    <path d="M 741.524688 442.08 
L 741.524688 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="patch_5">
    <path d="M 71.924688 442.08 
L 741.524688 442.08 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="patch_6">
    <path d="M 71.924688 7.2 
L 741.524688 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"/>
   </g>
   <g id="legend_1">
    <g id="patch_7">
     <path d="M 313.122187 113.94 
L 500.327188 113.94 
Q 503.527188 113.94 503.527188 110.74 
L 503.527188 18.4 
Q 503.527188 15.2 500.327188 15.2 
L 313.122187 15.2 
Q 309.922188 15.2 309.922188 18.4 
L 309.922188 110.74 
Q 309.922188 113.94 313.122187 113.94 
z
" style="fill:#ffffff;opacity:0.8;stroke:#cccccc;stroke-linejoin:miter;"/>
    </g>
    <g id="line2d_37">
     <path d="M 316.322187 28.1575 
L 348.322187 28.1575 
" style="fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;"/>
    </g>
    <g id="line2d_38">
     <g>
      <use style="fill:#1f77b4;stroke:#1f77b4;" x="332.322187" xlink:href="#mfd431abc88" y="28.1575"/>
     </g>
    </g>
    <g id="text_17">
     <!-- CHSH1 Noiseless -->
     <defs>
      <path d="M 9.8125 72.90625 
L 23.09375 72.90625 
L 55.421875 11.921875 
L 55.421875 72.90625 
L 64.984375 72.90625 
L 64.984375 0 
L 51.703125 0 
L 19.390625 60.984375 
L 19.390625 0 
L 9.8125 0 
z
" id="DejaVuSans-78"/>
      <path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"/>
      <path d="M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
" id="DejaVuSans-108"/>
     </defs>
     <g transform="translate(361.122187 33.7575)scale(0.16 -0.16)">
      <use xlink:href="#DejaVuSans-67"/>
      <use x="69.824219" xlink:href="#DejaVuSans-72"/>
      <use x="145.019531" xlink:href="#DejaVuSans-83"/>
      <use x="208.496094" xlink:href="#DejaVuSans-72"/>
      <use x="283.691406" xlink:href="#DejaVuSans-49"/>
      <use x="347.314453" xlink:href="#DejaVuSans-32"/>
      <use x="379.101562" xlink:href="#DejaVuSans-78"/>
      <use x="453.90625" xlink:href="#DejaVuSans-111"/>
      <use x="515.087891" xlink:href="#DejaVuSans-105"/>
      <use x="542.871094" xlink:href="#DejaVuSans-115"/>
      <use x="594.970703" xlink:href="#DejaVuSans-101"/>
      <use x="656.494141" xlink:href="#DejaVuSans-108"/>
      <use x="684.277344" xlink:href="#DejaVuSans-101"/>
      <use x="745.800781" xlink:href="#DejaVuSans-115"/>
      <use x="797.900391" xlink:href="#DejaVuSans-115"/>
     </g>
    </g>
    <g id="line2d_39">
     <path d="M 316.322187 51.6425 
L 348.322187 51.6425 
" style="fill:none;stroke:#ff7f0e;stroke-linecap:square;stroke-width:1.5;"/>
    </g>
    <g id="line2d_40">
     <g>
      <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="332.322187" xlink:href="#m0c5bcfc2d6" y="51.6425"/>
     </g>
    </g>
    <g id="text_18">
     <!-- CHSH2 Noiseless -->
     <g transform="translate(361.122187 57.2425)scale(0.16 -0.16)">
      <use xlink:href="#DejaVuSans-67"/>
      <use x="69.824219" xlink:href="#DejaVuSans-72"/>
      <use x="145.019531" xlink:href="#DejaVuSans-83"/>
      <use x="208.496094" xlink:href="#DejaVuSans-72"/>
      <use x="283.691406" xlink:href="#DejaVuSans-50"/>
      <use x="347.314453" xlink:href="#DejaVuSans-32"/>
      <use x="379.101562" xlink:href="#DejaVuSans-78"/>
      <use x="453.90625" xlink:href="#DejaVuSans-111"/>
      <use x="515.087891" xlink:href="#DejaVuSans-105"/>
      <use x="542.871094" xlink:href="#DejaVuSans-115"/>
      <use x="594.970703" xlink:href="#DejaVuSans-101"/>
      <use x="656.494141" xlink:href="#DejaVuSans-108"/>
      <use x="684.277344" xlink:href="#DejaVuSans-101"/>
      <use x="745.800781" xlink:href="#DejaVuSans-115"/>
      <use x="797.900391" xlink:href="#DejaVuSans-115"/>
     </g>
    </g>
    <g id="line2d_41">
     <path d="M 316.322187 75.1275 
L 348.322187 75.1275 
" style="fill:none;stroke:#2ca02c;stroke-linecap:square;stroke-width:1.5;"/>
    </g>
    <g id="line2d_42">
     <g>
      <use style="fill:#2ca02c;stroke:#2ca02c;" x="332.322187" xlink:href="#m7220c03c23" y="75.1275"/>
     </g>
    </g>
    <g id="text_19">
     <!-- CHSH1 Lima -->
     <defs>
      <path d="M 9.8125 72.90625 
L 19.671875 72.90625 
L 19.671875 8.296875 
L 55.171875 8.296875 
L 55.171875 0 
L 9.8125 0 
z
" id="DejaVuSans-76"/>
      <path d="M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
" id="DejaVuSans-109"/>
     </defs>
     <g transform="translate(361.122187 80.7275)scale(0.16 -0.16)">
      <use xlink:href="#DejaVuSans-67"/>
      <use x="69.824219" xlink:href="#DejaVuSans-72"/>
      <use x="145.019531" xlink:href="#DejaVuSans-83"/>
      <use x="208.496094" xlink:href="#DejaVuSans-72"/>
      <use x="283.691406" xlink:href="#DejaVuSans-49"/>
      <use x="347.314453" xlink:href="#DejaVuSans-32"/>
      <use x="379.101562" xlink:href="#DejaVuSans-76"/>
      <use x="434.814453" xlink:href="#DejaVuSans-105"/>
      <use x="462.597656" xlink:href="#DejaVuSans-109"/>
      <use x="560.009766" xlink:href="#DejaVuSans-97"/>
     </g>
    </g>
    <g id="line2d_43">
     <path d="M 316.322187 98.6125 
L 348.322187 98.6125 
" style="fill:none;stroke:#d62728;stroke-linecap:square;stroke-width:1.5;"/>
    </g>
    <g id="line2d_44">
     <g>
      <use style="fill:#d62728;stroke:#d62728;" x="332.322187" xlink:href="#ma6884bf940" y="98.6125"/>
     </g>
    </g>
    <g id="text_20">
     <!-- CHSH2 Lima -->
     <g transform="translate(361.122187 104.2125)scale(0.16 -0.16)">
      <use xlink:href="#DejaVuSans-67"/>
      <use x="69.824219" xlink:href="#DejaVuSans-72"/>
      <use x="145.019531" xlink:href="#DejaVuSans-83"/>
      <use x="208.496094" xlink:href="#DejaVuSans-72"/>
      <use x="283.691406" xlink:href="#DejaVuSans-50"/>
      <use x="347.314453" xlink:href="#DejaVuSans-32"/>
      <use x="379.101562" xlink:href="#DejaVuSans-76"/>
      <use x="434.814453" xlink:href="#DejaVuSans-105"/>
      <use x="462.597656" xlink:href="#DejaVuSans-109"/>
      <use x="560.009766" xlink:href="#DejaVuSans-97"/>
     </g>
    </g>
   </g>
  </g>
 </g>
 <defs>
  <clipPath id="p166b506543">
   <rect height="434.88" width="669.6" x="71.924688" y="7.2"/>
  </clipPath>
 </defs>
</svg>

</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note what happened! There are some particular combination of measurement bases for which $|CHSH| \geq 2$. How is this possible? Let's look at our entangled bipartite system. It is easy to show that if $|\psi \rangle = 1/\sqrt{2} (|00\rangle + |11\rangle)$, then the expectation value $\langle AB \rangle = \langle \psi|A \otimes B| \psi \rangle = -\cos \theta_{AB}$ where $\theta_{AB}$ is the angle between the measurement bases $A$ and $B$. Therefore, for the particular choise of bases $A = 1/\sqrt{2}(\sigma_z - \sigma_x)$ and $a = 1/\sqrt{2}(\sigma_z + \sigma_x)$, letting Bob measure with $B=\sigma_z$ and $b=\sigma_x$, we see that $|\langle CHSH1 \rangle| = 2\sqrt{2} &gt; 2$. It can also be shown that $2\sqrt{2}$ is the maximum possible value attainable, even in the quantum case (dash-dotted line in the plot).</p>
<p>The above inequality is called CHSH after Clauser, Horne, Shimony, and Holt, and it is the most popular way of presenting the original inequality from Bell.</p>
<p>The fact that we violated the CHSH inequality in our real device is of significance. Just a decade ago such an experiment would have been of great impact. Nowadays, quantum devices have become significantly better and these results can be replicated easily in state-of-the-art hardware. However, there are a number of loopholes that have to be closed when violating the inequality in order to claim that either locality or realism have been disproven. These are the detection loophole (where our detector is faulty and fails to provide meaningful statistics) and the locality/causality loophole (where the two parts of the entangled system are separated by a distance smaller than the distance covered by the light in the time it takes to perform a measurement). Given we can generate entangled pairs with high fidelity and every measurement yields a result (this is, no measured particle is "lost"), we have closed the detection loophole in our experiments above. However, given the distance between our qubits (a few mm) and the time it takes to perform a measurement (order of $\mu$s), we cannot claim we closed the causality loophole.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exercise">Exercise<a class="anchor-link" href="#Exercise"> </a></h3><p>Consider a game where Alice and Bob are put in separate rooms and each is given a bit $x$ and $y$, respectively. These bits are chosen at random and idependently of each other. On receiving the bit each of them replies with a bit of their own, $a$ and $b$. Now, Alice and Bob win the game if $a$ and $b$ are different whenever $x=y=1$ and equal otherwise. It is easy to see that the best possible strategy for Alice and Bob is to always give $a=b=0$ (or $1$). With this strategy, Alice and Bob can win the game at most 75% of the time.</p>
<p>Imagine Alice and Bob are allowed to share an entangled two-qubit state. Is there a strategy they can use that would give them a better chance of winning than 75%? (Remember that they can agree upon any strategy beforehand, but once they are given the random bits they cannot communicate anymore. They can take their respective parts of the entangled pair with them at all times, of course.)</p>

</div>
</div>
</div>
</div>

 


    </main>
    
            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  
    
    

    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/textbook/ch-demos/piday-code.html">
      〈 <span class="u-margin-right-tiny"></span> Estimating Pi Using Quantum Phase ...
    </a>
  

  
    

    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/textbook/widgets-index.html">
      Interactivity Index <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="https://github.com/jupyter/jupyter-book/graphs/contributors">The Jupyter Book Community</a></p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
