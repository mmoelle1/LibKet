<!DOCTYPE html>



<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Simulating Molecules using VQE</title>
  <meta name="description" content="A cross-platform programming framework for quantum-accelerated scientific computing">

  <link rel="canonical" href="https://libket.ewi.tudelft.nl/textbook/ch-applications/vqe-molecules.html">
  <link rel="alternate" type="application/rss+xml" title="LibKet Learn" href="https://libket.ewi.tudelft.nl/textbook/feed.xml">

  

  <link rel="alternate" hreflang="en" href="https://libket.ewi.tudelft.nl/textbook/ch-applications/vqe-molecules.html" />
  <link rel="alternate" hreflang="ja" href="https://libket.ewi.tudelft.nl/textbook/ja/ch-applications/vqe-molecules.html" />
  <link rel="alternate" hreflang="x-default" href="https://libket.ewi.tudelft.nl/textbook/ch-applications/vqe-molecules.html" />

  <meta property="og:url"         content="https://libket.ewi.tudelft.nl/textbook/ch-applications/vqe-molecules.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Simulating Molecules using VQE" />
<meta property="og:description" content="A cross-platform programming framework for quantum-accelerated scientific computing" />
<meta property="og:image"       content="https://libket.ewi.tudelft.nl/textbook/images/preface_illustration.svg" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://libket.ewi.tudelft.nl/textbook/ch-applications/vqe-molecules.html",
  "headline": "Simulating Molecules using VQE",
  "datePublished": "2021-04-20T14:56:01+00:00",
  "dateModified": "2021-04-20T14:56:01+00:00",
  "description": "        Simulating Molecules using VQE    In this tutorial, we introduce the Variational Quantum Eigensolver (VQE), motivate its use, explain the necessary t...",
  "author": {
    "@type": "Person",
    "name": "The LibKet Team"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://libket.ewi.tudelft.nl/textbook",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://libket.ewi.tudelft.nl/textbook",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link id="theme-style" rel="stylesheet" href="/textbook/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/textbook/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML-full,Safe' async></script>


  <!-- DOM updating function -->
  <script src="/textbook/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/textbook/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/textbook';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/textbook/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <!-- Turbolinks were causing problems with equations in details tags, I have
	  removed them for now as I didn't notice a siginificant difference in
	  loading time, but maybe someone more knowledgeable than me can sort
	  the problem properly and re-enable -Frank
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">
  -->

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


<!-- Display Thebelab button in each code cell -->
<script>
/**
 * Set up thebelab button for code blocks
 */

const thebelabCellButton = id =>
  `<a id="thebelab-cell-button-${id}" class="btn thebebtn">
    <button>try</button>
  </a>`


const addThebelabButtonToCodeCells =  () => {

  const codeCells = document.querySelectorAll('div.input_area > div.highlight:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("thebelab-cell-button-" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', thebelabCellButton(id));
    }
  })
}

initFunction(addThebelabButtonToCodeCells);
</script>



<script>
    /**
     * Thebelab loads "reset CSS" after the theme styles load and so,
     * it invalidates part of the theme rules. To make the theme CSS to take
     * the correct precedence, we listen for Thebelab to finish loading, then
     * relocate the theme CSS and start Thebelab.
     */
    const thebeLabScript = document.createElement('script');
    thebeLabScript.src = "/textbook/assets/vendor/thebelab/index.js"
    thebeLabScript.async = true
    thebeLabScript.onload = () => {
        setTimeout(() => {
            document.head.append(
                ...document.querySelectorAll('#theme-style, #custom-style'))
        })
        initFunction(initThebelab)
    }
    document.head.append(thebeLabScript);

    /**
     * Add attributes to Thebelab blocks
     */
    function initThebelab() {
        const addThebelabToCodeCells = () => {
            console.log("Adding thebelab to code cells...");
            // If Thebelab hasn't loaded, wait a bit and try again. This
            // happens because we load ClipboardJS asynchronously.
            if (window.thebelab === undefined) {
                setTimeout(addThebelabToCodeCells, 250)
            return
            }

            // If we already detect a Thebelab cell, don't re-run
            if (document.querySelectorAll('div.thebelab-cell').length > 0) {
                return;
            }

            // Find all non-hardware, code cells, replace with Thebelab interactive code cells
            const hardwareTag = 'uses-hardware'
            const hardwareQuery = `.jb_cell.tag_${hardwareTag}`
            const noHardwareQuery = `.jb_cell:not(.tag_${hardwareTag})`
            const codeCells = document.querySelectorAll(`${noHardwareQuery} pre[id^="codecell"]`)
            codeCells.forEach((codeCell, index) => {
                const id = codeCellId(index)

                // Clean up the language to make it work w/ CodeMirror and add it to the cell
                dataLanguage = ""
                dataLanguage = detectLanguage(dataLanguage);
                codeCell.setAttribute('data-language', dataLanguage)
                codeCell.setAttribute('data-executable', 'true')

                // If the code cell is hidden, show it
                var inputCheckbox = document.querySelector(`input#hidebtn${codeCell.id}`);
                if (inputCheckbox !== null) {
                    setCodeCellVisibility(inputCheckbox, 'visible');
                }
            });

            // Create link to IQX and hardware notice template
            const currentPath = window.location.pathname
            const contentPath = currentPath.slice('/textbook'.length)
            const notebookPath = contentPath.replace(/\.html$/, '.ipynb')
            const iqxUrl = `https://quantum-computing.ibm.com/jupyter/user/qiskit-textbook/content${notebookPath}`

            const usesHardwareNotice = document.createElement('template')
            usesHardwareNotice.innerHTML = `
            <div class="uses-hardware-notice">
                This cell uses quantum hardware. To run it in your browser, please 
                <a href="${iqxUrl}" target="_blank">click here to go to the IBM Quantum Experience.</a>
            </div>
            `

            // Add warning and link to IQX on uses-hardware cells
            const hardwareCells = document.querySelectorAll(hardwareQuery)
            hardwareCells.forEach((cell) => {
                cell.prepend(usesHardwareNotice.content.cloneNode(true))
                cell.querySelector('a').addEventListener('click', (evt) => {
                    try {
                        window.trackCta(`Hardware Cell ${getInputCell(evt.target)}`)
                    } catch {}
                    return true;
                })
            });

            // Remove the event listener from the page so keyboard press doesn't
            // Change page
            document.removeEventListener('keydown', initPageNav)
            keyboardListener = false;

            // Init thebelab
            thebelab.bootstrap();

            // Remove copy buttons since they won't work anymore
            const copyAndThebeButtons = document.querySelectorAll(`${noHardwareQuery} .copybtn, .thebebtn`)
            copyAndThebeButtons.forEach((button, index) => {
                button.remove();
            });

            // Remove outputs since they'll be stale (ignore outputs with removed inputs)
            const outputs = document.querySelectorAll(':not(.tag_remove_input) > .output_wrapper')
            outputs.forEach((output, index) => {
                output.remove();
            });

            // Find any cells with an initialization tag and ask ThebeLab to run them when ready
            var thebeInitCells = document.querySelectorAll('div.tag_thebelab-init');
            thebeInitCells.forEach((cell) => {
                console.log("Initializing ThebeLab with cell: " + cell.id);
                cell.querySelector('.thebelab-run-button').click();
            });

            // Add analytics per cell
            const thebelabRunButtons = document.querySelectorAll('.thebelab-run-button');
            thebelabRunButtons.forEach((runButton) => {
                runButton.addEventListener('click', (evt) => {
                    window.trackCta(`Run ${getInputCell(evt.target)}`)
                })
            });
        }

        // Add event listener for the function to modify code cells
        const thebelabButtons = document.querySelectorAll('[id^=thebelab], [id$=thebelab]')
        thebelabButtons.forEach((thebelabButton,index) => {
            if (thebelabButton === null) {
                setTimeout(initThebelab, 250)
                return
            };
            thebelabButton.addEventListener('click', addThebelabToCodeCells);
            // Add segment analytics
            thebelabButton.addEventListener('click', () => {
                window.trackCta('Make Interactive');
            });
        });

        function getInputCell(button) {
            const parent = button.parentElement;
            if (parent === null) {
                return 'unknown';
            }
            if (parent.id.startsWith('inputcell')) {
                return parent.id;
            }
            return getInputCell(parent);
        }
    }

// Helper function to munge the language name
var detectLanguage = (language) => {
    if (language.indexOf('python') > -1) {
        language = "python";
    }
    return language;
}
</script>



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/textbook/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  


  <!-- Segment analytics -->
  <script>
(function () {
  'use strict'
  window._analytics = {
    segment_key: 'ffdYLviQze3kzomaINXNk6NwpY9LlXcw',
    coremetrics: false,
    optimizely: false,
    googleAddServices: false,
    fullStory: false,
    autoPageEventSpa: false,
    autoFormEvents: false,
    autoPageView: false
  }

  window.digitalData = {
    page: {
      pageInfo: {
        productTitle: 'IBM Q Experience',
        analytics: {
          category: 'Qiskit.org'
        }
      }
    }
  }

  loadAsyncScript('https://cloud.ibm.com/analytics/build/bluemix-analytics.min.js')
  .then(() => {
    if (!window.bluemixAnalytics || !window.digitalData) { return }

    const category = window.digitalData.page.pageInfo.analytics.category
    const productTitle = window.digitalData.page.pageInfo.productTitle
    const routeName = 'qiskit-textbook'

    window.bluemixAnalytics.pageEvent(category, routeName, {
      navigationType: 'pushState',
      productTitle: productTitle,
      title: document.title
    })
  })
  .catch((err) => {
    console.warn('Error loading Bluemix Analytics script:', err)
  })

  window.trackCta = (action) => {
    if (!window.bluemixAnalytics || !window.digitalData) { return }

    const category = window.digitalData.page.pageInfo.analytics.category
    const productTitle = window.digitalData.page.pageInfo.productTitle

    window.bluemixAnalytics.trackEvent('CTA Clicked', {
      productTitle,
      category,
      CTA: action
    })
  }

}());
</script>

  <!-- Hotjar -->
  <script>
  (function(h,o,t,j,a,r){
    h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
    h._hjSettings={hjid:1586421,hjsv:6};
    a=o.getElementsByTagName('head')[0];
    r=o.createElement('script');r.async=1;
    r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
    a.appendChild(r);
  })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>


  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/textbook/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/textbook/assets/custom/custom.js" async></script>
  <link id="custom-style" rel="stylesheet" href="/textbook/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("https://libket.ewi.tudelft.nl") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

// Fills in the search input with the query in the url
var prepopulateSearchInput = function () {
  var searchInput = document.getElementById('lunr_search');
  if (!searchInput) { return }

  var params = new URLSearchParams(window.location.search)
  var searchValue = params.get('search')
  if (!searchValue) { return }
  searchInput.value = searchValue.trim()
}

// Simulate a 'keyup' event to trigger a search
var triggerSearch = function () {
  var searchInput = document.getElementById('lunr_search');
  if (!searchInput || !searchInput.value.trim()) { return }

  searchInput.focus();
  var enterEvent = document.createEvent('Event');
  enterEvent.initEvent('keyup');
  searchInput.dispatchEvent(enterEvent);
}

initFunction(prepopulateSearchInput)

loadAsyncScript('https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js')
.then(() => {
  initFunction(initQuery)
  initFunction(triggerSearch)
})
.catch((err) => console.error('Cannot load lunr search engine:', err))
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/textbook/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/textbook/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/textbook/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "Made with Jupyter Book"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "mmoelle1/LibKet",
    ref: "master",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: ""
    },
    kernelOptions: {
    kernelName: "qiskit",
    path: "content/ch-applications"
    }
}
</script>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
    <div id="qiskit-navbar" class="qiskit__navbar">
    


<ul class="qiskit-navbar">
    <li class="left navbar__logo">
	    <a href="https://libket.ewi.tudelft.nl/">
	    <img src="/textbook/assets/images/logo_libket.png">
	    </a>
    </li>
    <li class="qiskit-navbar__icons"><a href="/textbook/search.html"><img src="/textbook/assets/images/search-solid-purple.svg"></a></li>
    <li class="entry__active"><a href="https://libket.readthedocs.io/">Documentation</a></li>
 </ul>


    </div>

      






<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="/textbook/preface.html"><h2 class="c-sidebar__title">Learn Quantum Computation using LibKet</h2></a>
  <ul class="c-sidebar__chapters">
    
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/preface">
        <a class="c-sidebar__entry"
          href="/textbook/preface.html"
        >
          
          Learn Quantum Computation using Qiskit
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/what-is-quantum">
        <a class="c-sidebar__entry"
          href="/textbook/what-is-quantum.html"
        >
          
          What is Quantum?
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-prerequisites/setting-the-environment.html">
        <a class="c-sidebar__entry"
          href="/textbook/ch-prerequisites/setting-the-environment.html"
        >
          
            0.
          
          Prerequisites
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-prerequisites/setting-the-environment">
              <a class="c-sidebar__entry"
                href="/textbook/ch-prerequisites/setting-the-environment.html"
              >
                
                  0.1
                
                Setting Up Your Environment
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-prerequisites/python-and-jupyter-notebooks">
              <a class="c-sidebar__entry"
                href="/textbook/ch-prerequisites/python-and-jupyter-notebooks.html"
              >
                
                  0.2
                
                Python and Jupyter Notebooks
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-cse21/cse21_tutorial01.html">
        <a class="c-sidebar__entry"
          href="/textbook/ch-cse21/cse21_tutorial01.html"
        >
          
            1.
          
          SIAM CSE1 Tutorial
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-cse21/cse21_tutorial01">
              <a class="c-sidebar__entry"
                href="/textbook/ch-cse21/cse21_tutorial01.html"
              >
                
                  1.1
                
                Part 1
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-cse21/cse21_tutorial02">
              <a class="c-sidebar__entry"
                href="/textbook/ch-cse21/cse21_tutorial02.html"
              >
                
                  1.2
                
                Part 2
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-cse21/cse21_tutorial03">
              <a class="c-sidebar__entry"
                href="/textbook/ch-cse21/cse21_tutorial03.html"
              >
                
                  1.3
                
                Part 3
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-states/introduction.html">
        <a class="c-sidebar__entry"
          href="/textbook/ch-states/introduction.html"
        >
          
            2.
          
          Quantum States and Qubits
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/introduction">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/introduction.html"
              >
                
                  2.1
                
                Introduction
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/atoms-computation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/atoms-computation.html"
              >
                
                  2.2
                
                The Atoms of Computation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/representing-qubit-states">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/representing-qubit-states.html"
              >
                
                  2.3
                
                Representing Qubit States
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/single-qubit-gates">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/single-qubit-gates.html"
              >
                
                  2.4
                
                Single Qubit Gates
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-states/case-for-quantum">
              <a class="c-sidebar__entry"
                href="/textbook/ch-states/case-for-quantum.html"
              >
                
                  2.5
                
                The Case for Quantum
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-gates/introduction.html">
        <a class="c-sidebar__entry"
          href="/textbook/ch-gates/introduction.html"
        >
          
            3.
          
          Multiple Qubits and Entanglement
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/introduction">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/introduction.html"
              >
                
                  3.1
                
                Introduction
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/multiple-qubits-entangled-states">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/multiple-qubits-entangled-states.html"
              >
                
                  3.2
                
                Multiple Qubits and Entangled States
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/phase-kickback">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/phase-kickback.html"
              >
                
                  3.3
                
                Phase Kickback
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/more-circuit-identities">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/more-circuit-identities.html"
              >
                
                  3.4
                
                More Circuit Identities
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/proving-universality">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/proving-universality.html"
              >
                
                  3.5
                
                Proving Universality
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-gates/oracles">
              <a class="c-sidebar__entry"
                href="/textbook/ch-gates/oracles.html"
              >
                
                  3.6
                
                Classical Computation on a Quantum Computer
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-algorithms/index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-algorithms/index.html"
        >
          
            4.
          
          Quantum Protocols and Quantum Algorithms
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/defining-quantum-circuits">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/defining-quantum-circuits.html"
              >
                
                  4.1
                
                Defining Quantum Circuits
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/deutsch-jozsa">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/deutsch-jozsa.html"
              >
                
                  4.2
                
                Deutsch-Jozsa Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/bernstein-vazirani">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/bernstein-vazirani.html"
              >
                
                  4.3
                
                Bernstein-Vazirani Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/simon">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/simon.html"
              >
                
                  4.4
                
                Simon's Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/quantum-fourier-transform">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/quantum-fourier-transform.html"
              >
                
                  4.5
                
                Quantum Fourier Transform
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/quantum-phase-estimation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/quantum-phase-estimation.html"
              >
                
                  4.6
                
                Quantum Phase Estimation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/shor">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/shor.html"
              >
                
                  4.7
                
                Shor's Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/grover">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/grover.html"
              >
                
                  4.8
                
                Grover's Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/quantum-counting">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/quantum-counting.html"
              >
                
                  4.9
                
                Quantum Counting
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/teleportation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/teleportation.html"
              >
                
                  4.10
                
                Quantum Teleportation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/superdense-coding">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/superdense-coding.html"
              >
                
                  4.11
                
                Superdense Coding
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-algorithms/quantum-key-distribution">
              <a class="c-sidebar__entry"
                href="/textbook/ch-algorithms/quantum-key-distribution.html"
              >
                
                  4.12
                
                Quantum Key Distribution
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-applications/algs_for_apps_index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-applications/algs_for_apps_index.html"
        >
          
            5.
          
          Quantum Algorithms for Applications
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-applications/apps_index">
              <a class="c-sidebar__entry"
                href="/textbook/ch-applications/apps_index.html"
              >
                
                  5.1
                
                Applied Quantum Algorithms
              </a>
            </li>
            
              
              <ul class='c-sidebar__subsections'>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/hhl_tutorial">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/hhl_tutorial.html"
                  >
                    
                      5.1.1
                      
                    
                    Solving Linear Systems of Equations using HHL
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/vqe-molecules">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/vqe-molecules.html"
                  >
                    
                      5.1.2
                      
                    
                    Simulating Molecules using VQE
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/qaoa">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/qaoa.html"
                  >
                    
                      5.1.3
                      
                    
                    Solving combinatorial optimization problems using QAOA
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/satisfiability-grover">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/satisfiability-grover.html"
                  >
                    
                      5.1.4
                      
                    
                    Solving Satisfiability Problems using Grover's Algorithm
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-machine-learning/machine-learning-qiskit-pytorch">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-machine-learning/machine-learning-qiskit-pytorch.html"
                  >
                    
                      5.1.5
                      
                    
                    Hybrid quantum-classical Neural Networks with PyTorch and Qiskit
                  </a>
                </li>
              
              </ul>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-applications/imp_index">
              <a class="c-sidebar__entry"
                href="/textbook/ch-applications/imp_index.html"
              >
                
                  5.2
                
                Implementations of Recent Quantum Algorithms
              </a>
            </li>
            
              
              <ul class='c-sidebar__subsections'>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-paper-implementations/vqls">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-paper-implementations/vqls.html"
                  >
                    
                      5.2.1
                      
                    
                    Variational Quantum Linear Solver
                  </a>
                </li>
              
                
                
                
                
                <li class="c-sidebar__subsection" data-url="/ch-applications/image-processing-frqi-neqr">
                  <a class="c-sidebar__entry"
                    href="/textbook/ch-applications/image-processing-frqi-neqr.html"
                  >
                    
                      5.2.2
                      
                    
                    Quantum Image Processing - FRQI and NEQR Image Representations
                  </a>
                </li>
              
              </ul>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-quantum-hardware/index-circuits">
        <a class="c-sidebar__entry"
          href="/textbook/ch-quantum-hardware/index-circuits.html"
        >
          
            6.
          
          Investigating Quantum Hardware Using Quantum Circuits
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/error-correction-repetition-code">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/error-correction-repetition-code.html"
              >
                
                  6.1
                
                Introduction to Quantum Error Correction using Repetition Codes
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/measurement-error-mitigation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/measurement-error-mitigation.html"
              >
                
                  6.2
                
                Measurement Error Mitigation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/randomized-benchmarking">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/randomized-benchmarking.html"
              >
                
                  6.3
                
                Randomized Benchmarking
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/measuring-quantum-volume">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/measuring-quantum-volume.html"
              >
                
                  6.4
                
                Measuring Quantum Volume
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-quantum-hardware/index-pulses">
        <a class="c-sidebar__entry"
          href="/textbook/ch-quantum-hardware/index-pulses.html"
        >
          
            7.
          
          Investigating Quantum Hardware Using Microwave Pulses
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/calibrating-qubits-pulse">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/calibrating-qubits-pulse.html"
              >
                
                  7.1
                
                Calibrating Qubits with Qiskit Pulse
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/accessing_higher_energy_states">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/accessing_higher_energy_states.html"
              >
                
                  7.2
                
                Accessing Higher Energy States
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/transmon-physics">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/transmon-physics.html"
              >
                
                  7.3
                
                Introduction to Transmon Physics
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/cQED-JC-SW">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/cQED-JC-SW.html"
              >
                
                  7.4
                
                Circuit Quantum Electrodynamics
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/Jaynes-Cummings-model">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/Jaynes-Cummings-model.html"
              >
                
                  7.5
                
                Exploring the Jaynes-Cummings Hamiltonian with Qiskit Pulse
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/ac-Stark-shift">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/ac-Stark-shift.html"
              >
                
                  7.6
                
                Measuring the Qubit ac-Stark Shift
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-quantum-hardware/hamiltonian-tomography">
              <a class="c-sidebar__entry"
                href="/textbook/ch-quantum-hardware/hamiltonian-tomography.html"
              >
                
                  7.7
                
                Hamiltonian Tomography
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-labs/index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-labs/index.html"
        >
          
            8.
          
          Quantum Computing Labs
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab01_QuantumCircuits">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab01_QuantumCircuits.html"
              >
                
                Lab 1. Quantum Circuits
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab02_QuantumMeasurement">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab02_QuantumMeasurement.html"
              >
                
                Lab 2. Quantum Measurement
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab03_AccuracyQPE">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab03_AccuracyQPE.html"
              >
                
                Lab 3. Accuracy of Quantum Phase Estimation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab04_IterativePhaseEstimation">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab04_IterativePhaseEstimation.html"
              >
                
                Lab 4. Iterative Quantum Phase Estimation
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab05_Scalable_Shor_Algorithm">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab05_Scalable_Shor_Algorithm.html"
              >
                
                Lab 5. Scalable Shors Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab06_Grover_search_with_an_unknown_number_of_solutions">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab06_Grover_search_with_an_unknown_number_of_solutions.html"
              >
                
                Lab 6. Grover's search with an unknown number of solutions
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-labs/Lab07_QuantumSimulationSearchAlgorithm">
              <a class="c-sidebar__entry"
                href="/textbook/ch-labs/Lab07_QuantumSimulationSearchAlgorithm.html"
              >
                
                Lab 7. Quantum Simulation as a Search Algorithm
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-appendix/index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-appendix/index.html"
        >
          
            9.
          
          Appendix
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-appendix/linear_algebra">
              <a class="c-sidebar__entry"
                href="/textbook/ch-appendix/linear_algebra.html"
              >
                
                  9.1
                
                Linear Algebra
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-appendix/qiskit">
              <a class="c-sidebar__entry"
                href="/textbook/ch-appendix/qiskit.html"
              >
                
                  9.2
                
                Qiskit
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ch-demos/index">
        <a class="c-sidebar__entry"
          href="/textbook/ch-demos/index.html"
        >
          
            10.
          
          Games & Demos
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-ex/hello-qiskit">
              <a class="c-sidebar__entry"
                href="/textbook/ch-ex/hello-qiskit.html"
              >
                
                Hello Qiskit Game
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-demos/piday-code">
              <a class="c-sidebar__entry"
                href="/textbook/ch-demos/piday-code.html"
              >
                
                Estimating Pi Using Quantum Phase Estimation Algorithm
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ch-demos/chsh">
              <a class="c-sidebar__entry"
                href="/textbook/ch-demos/chsh.html"
              >
                
                Local Reality and the CHSH Inequality
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/widgets-index">
              <a class="c-sidebar__entry"
                href="/textbook/widgets-index.html"
              >
                
                Interactivity Index
              </a>
            </li>
            
            
          
        </ul>
      

      
    
  </ul>
  <div class="sidebar_footer">
    <!-- Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a> -->
    
    <div class="language_switcher">
      <select name="preferred_language" onchange="changeLocale('', this.value)">
        <option value="en" >English</option>
      </select>
    </div>

  </div>
</nav>

      
      

<div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="hamburger__left">
    <span id="js-sidebar-toggle" class="hamburger is-active">
	    <img class="sidebar_closed_img" src="/textbook/assets/images/rightarrow_purple.svg" title="Show Contents">
	    <img class="sidebar_open_img" src="/textbook/assets/images/leftarrow_purple.svg" title="Hide Contents">
    </span>
  </aside>
  
  <aside class="sidebar__right">
  
    <!-- Search form -->
    <header>
      <form action="/textbook/search.html" method="GET">
        <button type="submit" id="submit">
          <img src="/textbook/assets/images/search-solid.svg" alt="Search">
        </button>
        <input type="text" id="siderbar-search-input" name="search">
      </form>
    </header>

    
    <div class="onthispage__title">On This Page</div>
    <nav class="onthispage">
    </nav>
    <!-- Chapter formats -->
    
    <!--
    <div>      
      <a
        href="https://quantum-computing.ibm.com/jupyter/user/qiskit-textbook/content/ch-applications/vqe-molecules.ipynb"
        target="_blank"
        rel="noopener"
	onclick="window.trackCta('Open in IBM Quantum Experience')"
      >
      <button class="interact-button">Open in IBM Quantum Lab</button>
      </a>
    </div>
    -->
    <div>
      <a
        href="/textbook/content/ch-applications/vqe-molecules.ipynb"
        rel="noopener"
        class="download__link"
      >
        Download as Jupyter Notebook
        <img src="/textbook/assets/images/download-solid.svg" class="download-button">
      </a>
    </div>
   <div>
      <a
	href="https://github.com/mmoelle1/LibKet/tree/master/content/ch-applications/vqe-molecules.ipynb"
	class="download__link"
      >
      Contribute on Github
      <img src="/textbook/assets/images/launch.svg" class="download-button">
      </a>
    </div>
    <!--
    <div>
      <a
	href="https://www.surveygizmo.com/s3/6242342/1b1fc576f66d"
	class="download__link"
      >
      Sign Up for Beta Testing
      <img src="/textbook/assets/images/launch.svg" class="download-button">
      </a>
    </div>
    -->
    
  
  </aside>
  <!--
  <a href="/textbook/search.html" class="topbar-right-button" id="search-button">
    <img src="/textbook/assets/images/search-solid.svg" alt="Search" />
  </a>
  -->
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Simulating Molecules using VQE</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this tutorial, we introduce the Variational Quantum Eigensolver (VQE), motivate its use, explain the necessary theory, and demonstrate its implementation in finding the ground state energy of molecules.</p>
<h2 id="Contents">Contents<a class="anchor-link" href="#Contents"> </a></h2><ol>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#varmethod">The Variational Method of Quantum Mechanics</a><ol>
<li><a href="#backgroundmath">Mathematical Background</a></li>
<li><a href="#groundstate">Bounding the Ground State</a></li>
</ol>
</li>
<li><a href="#vqe">The Variational Quantum Eigensolver</a><ol>
<li><a href="#varforms">Variational Forms</a></li>
<li><a href="#simplevarform">Simple Variational Forms</a></li>
<li><a href="#optimization">Parameter Optimization</a></li>
<li><a href="#example">Example with a Single Qubit Variational Form</a></li>
<li><a href="#commonvarforms">Structure of Common Variational Forms</a></li>
</ol>
</li>
<li><a href="#implementation">VQE Implementation in Qiskit</a><ol>
<li><a href="#implementationstatevec">Running VQE on a Statevector Simulator</a></li>
<li><a href="#implementationnoisy">Running VQE on a Noisy Simulator</a></li>
</ol>
</li>
<li><a href="#problems">Problems</a></li>
<li><a href="#references">References</a></li>
</ol>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Introduction">Introduction<a id="introduction" /><a class="anchor-link" href="#Introduction"> </a></h2><p>In many applications it is important to find the minimum eigenvalue of a matrix. For example, in chemistry, the minimum eigenvalue of a Hermitian matrix characterizing the molecule is the ground state energy of that system. In the future, the quantum phase estimation algorithm may be used to find the minimum eigenvalue. However, its implementation on useful problems requires circuit depths exceeding the limits of hardware available in the NISQ era. Thus, in 2014, Peruzzo <em>et al.</em> proposed VQE to estimate the ground state energy of a molecule using much shallower circuits [1].</p>
<p>Formally stated, given a Hermitian matrix $H$ with an unknown minimum eigenvalue $\lambda_{min}$, associated with the eigenstate $|\psi_{min}\rangle$, VQE provides an estimate $\lambda_{\theta}$ bounding $\lambda_{min}$:</p>
\begin{align*}
    \lambda_{min} \le \lambda_{\theta} \equiv \langle \psi(\theta) |H|\psi(\theta) \rangle
\end{align*}<p></p>
<p>where $|\psi(\theta)\rangle$ is the eigenstate associated with $\lambda_{\theta}$. By applying a parameterized circuit, represented by $U(\theta)$, to some arbitrary starting state $|\psi\rangle$, the algorithm obtains an estimate $U(\theta)|\psi\rangle \equiv |\psi(\theta)\rangle$ on $|\psi_{min}\rangle$. The estimate is iteratively optimized by a classical controller changing the parameter $\theta$ minimizing the expectation value of $\langle \psi(\theta) |H|\psi(\theta) \rangle$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Variational-Method-of-Quantum-Mechanics">The Variational Method of Quantum Mechanics<a id="varmethod" /><a class="anchor-link" href="#The-Variational-Method-of-Quantum-Mechanics"> </a></h2><h3 id="Mathematical-Background">Mathematical Background<a id="backgroundmath" /><a class="anchor-link" href="#Mathematical-Background"> </a></h3><p>VQE is an application of the variational method of quantum mechanics. To better understand the variational method, some preliminary mathematical background is provided. An eigenvector, $|\psi_i\rangle$, of a matrix $A$ is invariant under transformation by $A$ up to a scalar multiplicative constant (the eigenvalue $\lambda_i$). That is,</p>
\begin{align*}
    A |\psi_i\rangle = \lambda_i |\psi_i\rangle
\end{align*}<p>Furthermore, a matrix $H$ is Hermitian when it is equal to its own conjugate transpose.</p>
\begin{align*}
    H = H^{\dagger}
\end{align*}<p>The spectral theorem states that the eigenvalues of a Hermitian matrix must be real. Thus, any eigenvalue of $H$ has the property that $\lambda_i = \lambda_i^*$. As any measurable quantity must be real, Hermitian matrices are suitable for describing the Hamiltonians of quantum systems. Moreover, $H$ may be expressed as</p>
\begin{align*}
    H = \sum_{i = 1}^{N} \lambda_i |\psi_i\rangle \langle \psi_i |
\end{align*}<p>where each $\lambda_i$ is the eigenvalue corresponding to the eigenvector $|\psi_i\rangle$. Furthermore, the expectation value of the observable $H$ on an arbitrary quantum state $|\psi\rangle$ is given by</p>
\begin{align}
    \langle H \rangle_{\psi} &amp;\equiv \langle \psi | H | \psi \rangle
\end{align}<p>Substituting $H$ with its representation as a weighted sum of its eigenvectors,</p>
\begin{align}
    \langle H \rangle_{\psi} = \langle \psi | H | \psi \rangle &amp;= \langle \psi | \left(\sum_{i = 1}^{N} \lambda_i |\psi_i\rangle \langle \psi_i |\right) |\psi\rangle\\
    &amp;= \sum_{i = 1}^{N} \lambda_i \langle \psi | \psi_i\rangle \langle \psi_i | \psi\rangle \\
    &amp;= \sum_{i = 1}^{N} \lambda_i | \langle \psi_i | \psi\rangle |^2
\end{align}<p>The last equation demonstrates that the expectation value of an observable on any state can be expressed as a linear combination using the eigenvalues associated with $H$ as the weights. Moreover, each of the weights in the linear combination is greater than or equal to 0, as $| \langle \psi_i | \psi\rangle |^2 \ge 0$ and so it is clear that</p>
\begin{align}
    \lambda_{min} \le \langle H \rangle_{\psi} = \langle \psi | H | \psi \rangle = \sum_{i = 1}^{N} \lambda_i | \langle \psi_i | \psi\rangle |^2
\end{align}<p>The above equation is known as the <strong>variational method</strong> (in some texts it is also known as the variational principle) [2]. It is important to note that this implies that the expectation value of any wave function will always be at least the minimum eigenvalue associated with $H$. Moreover, the expectation value of the eigenstate $|\psi_{min}\rangle$ is given by $\langle \psi_{min}|H|\psi_{min}\rangle = \langle \psi_{min}|\lambda_{min}|\psi_{min}\rangle = \lambda_{min}$. Thus, as expected, $\langle H \rangle_{\psi_{min}}=\lambda_{min}$.</p>
<h3 id="Bounding-the-Ground-State">Bounding the Ground State<a id="groundstate" /><a class="anchor-link" href="#Bounding-the-Ground-State"> </a></h3><p>When the Hamiltonian of a system is described by the Hermitian matrix $H$ the ground state energy of that system, $E_{gs}$, is the smallest eigenvalue associated with $H$. By arbitrarily selecting a wave function $|\psi \rangle$ (called an <em>ansatz</em>) as an initial guess approximating $|\psi_{min}\rangle$, calculating its expectation value, $\langle H \rangle_{\psi}$, and iteratively updating the wave function, arbitrarily tight bounds on the ground state energy of a Hamiltonian may be obtained.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Variational-Quantum-Eigensolver">The Variational Quantum Eigensolver<a id="vqe" /><a class="anchor-link" href="#The-Variational-Quantum-Eigensolver"> </a></h2><h3 id="Variational-Forms">Variational Forms<a id="varforms" /><a class="anchor-link" href="#Variational-Forms"> </a></h3><p>A systematic approach to varying the ansatz is required to implement the variational method on a quantum computer. VQE does so through the use of a parameterized circuit with a fixed form. Such a circuit is often called a <em>variational form</em>, and its action may be represented by the linear transformation $U(\theta)$. A variational form is applied to a starting state $|\psi\rangle$ (such as the vacuum state $|0\rangle$, or the Hartree Fock state) and generates an output state $U(\theta)|\psi\rangle\equiv |\psi(\theta)\rangle$. Iterative optimization over $|\psi(\theta)\rangle$ aims to yield an expectation value $\langle \psi(\theta)|H|\psi(\theta)\rangle \approx E_{gs} \equiv \lambda_{min}$. Ideally, $|\psi(\theta)\rangle$ will be close to $|\psi_{min}\rangle$ (where 'closeness' is characterized by either state fidelity, or Manhattan distance) although in practice, useful bounds on $E_{gs}$ can be obtained even if this is not the case.</p>
<p>Moreover, a fixed variational form with a polynomial number of parameters can only generate transformations to a polynomially sized subspace of all the states in an exponentially sized Hilbert space. Consequently, various variational forms exist. Some, such as Ry and RyRz are heuristically designed, without consideration of the target domain. Others, such as UCCSD, utilize domain specific knowledge to generate close approximations based on the problem's structure. The structure of common variational forms is discussed in greater depth later in this document.</p>
<h3 id="Simple-Variational-Forms">Simple Variational Forms<a id="simplevarform" /><a class="anchor-link" href="#Simple-Variational-Forms"> </a></h3><p>When constructing a variational form we must balance two opposing goals. Ideally, our $n$ qubit variational form would be able to generate any possible state $|\psi\rangle$ where $|\psi\rangle \in \mathbb{C}^N$ and $N=2^n$. However, we would like the variational form to use as few parameters as possible. Here, we aim to give intuition for the construction of variational forms satisfying our first goal, while disregarding the second goal for the sake of simplicity.</p>
<p>Consider the case where $n=1$. The U3 gate takes three parameters, $\theta, \phi$ and $\lambda$, and represents the following transformation:</p>
$$
\begin{align}
    U3(\theta, \phi, \lambda) = \begin{pmatrix}\cos(\frac{\theta}{2}) &amp; -e^{i\lambda}\sin(\frac{\theta}{2}) \\ e^{i\phi}\sin(\frac{\theta}{2}) &amp; e^{i\lambda + i\phi}\cos(\frac{\theta}{2}) \end{pmatrix}
\end{align}
$$<p>Up to a global phase, any possible single qubit transformation may be implemented by appropriately setting these parameters. Consequently, for the single qubit case, a variational form capable of generating any possible state is given by the circuit:</p>
<p><img src="./images/U3_var_form.png" alt="image1"></p>
<p>Moreover, this universal 'variational form' only has 3 parameters and thus can be efficiently optimized. It is worth emphasising that the ability to generate an arbitrary state ensures that during the optimization process, the variational form does not limit the set of attainable states over which the expectation value of $H$ can be taken. Ideally, this ensures that the minimum expectation value is limited only by the capabilities of the classical optimizer.</p>
<p>A less trivial universal variational form may be derived for the 2 qubit case, where two body interactions, and thus entanglement, must be considered to achieve universality. Based on the work presented by <em>Shende et al.</em> [3] the following is an example of a universal parameterized 2 qubit circuit:</p>
<p><img src="./images/two_qubit_var_form.png" alt="image2"></p>
<p>Allow the transformation performed by the above circuit to be represented by $U(\theta)$. When optimized variationally, the expectation value of $H$ is minimized when $U(\theta)|\psi\rangle \equiv |\psi(\theta)\rangle \approx |\psi_{min}\rangle$. By formulation, $U(\theta)$ may produce a transformation to any possible state, and so this variational form may obtain an arbitrarily tight bound on two qubit ground state energies, only limited by the capabilities of the classical optimizer.</p>
<h3 id="Parameter-Optimization">Parameter Optimization<a id="optimization" /><a class="anchor-link" href="#Parameter-Optimization"> </a></h3><p>Once an efficiently parameterized variational form has been selected, in accordance with the variational method, its parameters must be optimized to minimize the expectation value of the target Hamiltonian. The parameter optimization process has various challenges. For example, quantum hardware has various types of noise and so objective function evaluation (energy calculation) may not necessarily reflect the true objective function. Additionally, some optimizers perform a number of objective function evaluations dependent on cardinality of the parameter set. An appropriate optimizer should be selected by considering the requirements of an application.</p>
<p>A popular optimization strategy is gradient descent where each parameter is updated in the direction yielding the largest local change in energy. Consequently, the number of evaluations performed depends on the number of optimization parameters present. This allows the algorithm to quickly find a local optimum in the search space. However, this optimization strategy often gets stuck at poor local optima, and is relatively expensive in terms of the number of circuit evaluations performed. While an intuitive optimization strategy, it is not recommended for use in VQE.</p>
<p>An appropriate optimizer for optimizing a noisy objective function is the <em>Simultaneous Perturbation Stochastic Approximation</em> optimizer (SPSA). SPSA approximates the gradient of the objective function with only two measurements. It does so by concurrently perturbing all of the parameters in a random fashion, in contrast to gradient descent where each parameter is perturbed independently. When utilizing VQE in either a noisy simulator or on real hardware, SPSA is recommended as the classical optimizer.</p>
<p>When noise is not present in the cost function evaluation (such as when using VQE with a statevector simulator), a wide variety of classical optimizers may be useful. Two such optimizers supported by Qiskit Aqua are the <em>Sequential Least Squares Programming</em> optimizer (SLSQP) and the <em>Constrained Optimization by Linear Approximation</em> optimizer (COBYLA). It is worth noting that COBYLA only performs one objective function evaluation per optimization iteration (and thus the number of evaluations is independent of the parameter set's cardinality). Therefore, if the objective function is noise-free and minimizing the number of performed evaluations is desirable, it is recommended to try COBYLA.</p>
<h3 id="Example-with-a-Single-Qubit-Variational-Form">Example with a Single Qubit Variational Form<a id="example" /><a class="anchor-link" href="#Example-with-a-Single-Qubit-Variational-Form"> </a></h3><p>We will now use the simple single qubit variational form to solve a problem similar to ground state energy estimation. Specifically, we are given a random probability vector $\vec{x}$ and wish to determine a possible parameterization for our single qubit variational form such that it outputs a probability distribution that is close to $\vec{x}$ (where closeness is defined in terms of the Manhattan distance between the two probability vectors).</p>
<p>We first create the random probability vector in python:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">999999</span><span class="p">)</span>
<span class="n">target_distr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># We now convert the random vector into a valid probability vector</span>
<span class="n">target_distr</span> <span class="o">/=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">target_distr</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We subsequently create a function that takes the parameters of our single U3 variational form as arguments and returns the corresponding quantum circuit:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">QuantumCircuit</span><span class="p">,</span> <span class="n">ClassicalRegister</span><span class="p">,</span> <span class="n">QuantumRegister</span>
<span class="k">def</span> <span class="nf">get_var_form</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">qr</span> <span class="o">=</span> <span class="n">QuantumRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;q&quot;</span><span class="p">)</span>
    <span class="n">cr</span> <span class="o">=</span> <span class="n">ClassicalRegister</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">QuantumCircuit</span><span class="p">(</span><span class="n">qr</span><span class="p">,</span> <span class="n">cr</span><span class="p">)</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">u3</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">qr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">qc</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">qr</span><span class="p">,</span> <span class="n">cr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">qc</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we specify the objective function which takes as input a list of the variational form's parameters, and returns the cost associated with those parameters:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">Aer</span><span class="p">,</span> <span class="n">transpile</span><span class="p">,</span> <span class="n">assemble</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s2">&quot;qasm_simulator&quot;</span><span class="p">)</span>
<span class="n">NUM_SHOTS</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="k">def</span> <span class="nf">get_probability_distribution</span><span class="p">(</span><span class="n">counts</span><span class="p">):</span>
    <span class="n">output_distr</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="o">/</span> <span class="n">NUM_SHOTS</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">counts</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_distr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">output_distr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">output_distr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">output_distr</span>

<span class="k">def</span> <span class="nf">objective_function</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="c1"># Obtain a quantum circuit instance from the paramters</span>
    <span class="n">qc</span> <span class="o">=</span> <span class="n">get_var_form</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="c1"># Execute the quantum circuit to obtain the probability distribution associated with the current parameters</span>
    <span class="n">t_qc</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
    <span class="n">qobj</span> <span class="o">=</span> <span class="n">assemble</span><span class="p">(</span><span class="n">t_qc</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">NUM_SHOTS</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qobj</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
    <span class="c1"># Obtain the counts for each measured state, and convert those counts into a probability vector</span>
    <span class="n">output_distr</span> <span class="o">=</span> <span class="n">get_probability_distribution</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">qc</span><span class="p">))</span>
    <span class="c1"># Calculate the cost as the distance between the output distribution and the target distribution</span>
    <span class="n">cost</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">output_distr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">target_distr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">cost</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we create an instance of the COBYLA optimizer, and run the algorithm. Note that the output varies from run to run. Moreover, while close, the obtained distribution might not be exactly the same as the target distribution, however, increasing the number of shots taken will increase the accuracy of the output.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.aqua.components.optimizers</span> <span class="kn">import</span> <span class="n">COBYLA</span>

<span class="c1"># Initialize the COBYLA optimizer</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">COBYLA</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>

<span class="c1"># Create the initial parameters (noting that our single qubit variational form has 3 parameters)</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">num_vars</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">objective_function</span><span class="o">=</span><span class="n">objective_function</span><span class="p">,</span> <span class="n">initial_point</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># Obtain the output distribution using the final parameters</span>
<span class="n">qc</span> <span class="o">=</span> <span class="n">get_var_form</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">t_qc</span> <span class="o">=</span> <span class="n">transpile</span><span class="p">(</span><span class="n">qc</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
<span class="n">qobj</span> <span class="o">=</span> <span class="n">assemble</span><span class="p">(</span><span class="n">t_qc</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">NUM_SHOTS</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qobj</span><span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">get_counts</span><span class="p">(</span><span class="n">qc</span><span class="p">)</span>
<span class="n">output_distr</span> <span class="o">=</span> <span class="n">get_probability_distribution</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Target Distribution:&quot;</span><span class="p">,</span> <span class="n">target_distr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Obtained Distribution:&quot;</span><span class="p">,</span> <span class="n">output_distr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output Error (Manhattan Distance):&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parameters Found:&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>&lt;ipython-input-2-9c1182150c31&gt;:6: DeprecationWarning: The QuantumCircuit.u3 method is deprecated as of 0.16.0. It will be removed no earlier than 3 months after the release date. You should use QuantumCircuit.u instead, which acts identically. Alternatively, you can decompose u3 in terms of QuantumCircuit.p and QuantumCircuit.sx: u3(,,) = p(+) sx p(+) sx p() (2 pulses on hardware).
  qc.u3(params[0], params[1], params[2], qr[0])
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Target Distribution: [0.51357006 0.48642994]
Obtained Distribution: [0.5205, 0.4795]
Output Error (Manhattan Distance): 0.023259881261160853
Parameters Found: [1.53439896 0.07596288 0.65167175]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Structure-of-Common-Variational-Forms">Structure of Common Variational Forms<a id="commonvarforms" /><a class="anchor-link" href="#Structure-of-Common-Variational-Forms"> </a></h3><p>As already discussed, it is not possible for a polynomially parameterized variational form to generate a transformation to any state. Variational forms can be grouped into two categories, depending on how they deal with this limitation. The first category of variational forms use domain or application specific knowledge to limit the set of possible output states. The second approach uses a heuristic circuit without prior domain or application specific knowledge.</p>
<p>The first category of variational forms exploit characteristics of the problem domain to restrict the set of transformations that may be required. For example, when calculating the ground state energy of a molecule, the number of particles in the system is known <em>a priori</em>. Therefore, if a starting state with the correct number of particles is used, by limiting the variational form to only producing particle preserving transformations, the number of parameters required to span the new transformation subspace can be greatly reduced. Indeed, by utilizing similar information from Coupled-Cluster theory, the variational form UCCSD can obtain very accurate results for molecular ground state energy estimation when starting from the Hartree Fock state. Another example illustrating the exploitation of domain-specific knowledge follows from considering the set of circuits realizable on real quantum hardware. Extant quantum computers, such as those based on super conducting qubits, have limited qubit connectivity. That is, it is not possible to implement 2-qubit gates on arbitrary qubit pairs (without inserting swap gates). Thus, variational forms have been constructed for specific quantum computer architectures where the circuits are specifically tuned to maximally exploit the natively available connectivity and gates of a given quantum device. Such a variational form was used in 2017 to successfully implement VQE for the estimation of the ground state energies of molecules as large as BeH$_2$ on an IBM quantum computer [4].</p>
<p>In the second approach, gates are layered such that good approximations on a wide range of states may be obtained. Qiskit Aqua supports three such variational forms: RyRz, Ry and SwapRz (we will only discuss the first two). All of these variational forms accept multiple user-specified configurations. Three essential configurations are the number of qubits in the system, the depth setting, and the entanglement setting. A single layer of a variational form specifies a certain pattern of single qubit rotations and CX gates. The depth setting says how many times the variational form should repeat this pattern. By increasing the depth setting, at the cost of increasing the number of parameters that must be optimized, the set of states the variational form can generate increases. Finally, the entanglement setting selects the configuration, and implicitly the number, of CX gates. For example, when the entanglement setting is linear, CX gates are applied to adjacent qubit pairs in order (and thus $n-1$ CX gates are added per layer). When the entanglement setting is full, a CX gate is applied to each qubit pair in each layer. The circuits for RyRz corresponding to <code>entanglement="full"</code> and <code>entanglement="linear"</code> can be seen by executing the following code snippet:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">EfficientSU2</span>
<span class="n">entanglements</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;full&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">entanglement</span> <span class="ow">in</span> <span class="n">entanglements</span><span class="p">:</span>
    <span class="n">form</span> <span class="o">=</span> <span class="n">EfficientSU2</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">entanglement</span><span class="o">=</span><span class="n">entanglement</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">entanglement</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=============Linear Entanglement:=============&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=============Full Entanglement:=============&quot;</span><span class="p">)</span>
    <span class="c1"># We initialize all parameters to 0 for this demonstration</span>
    <span class="n">display</span><span class="p">(</span><span class="n">form</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">fold</span><span class="o">=</span><span class="mi">100</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>=============Linear Entanglement:=============
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/ch-applications/vqe-molecules_12_1.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
=============Full Entanglement:=============
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/ch-applications/vqe-molecules_12_3.png"
>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Assume the depth setting is set to $d$. Then, RyRz has $2n\times (d+1)$ parameters and Ry (not shown) has $n\times (d+1)$ parameters.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="VQE-Implementation-in-Qiskit">VQE Implementation in Qiskit<a id="implementation" /><a class="anchor-link" href="#VQE-Implementation-in-Qiskit"> </a></h2><p>This section illustrates an implementation of VQE using the programmatic approach. Qiskit Aqua also enables a declarative implementation, however, it reveals less information about the underlying algorithm. This code, specifically the preparation of qubit operators, is based on the code found in the Qiskit Tutorials repository (and as of July 2019, may be found at: <a href="https://github.com/Qiskit/qiskit-tutorials">https://github.com/Qiskit/qiskit-tutorials</a> ).</p>
<p>The following libraries must first be imported.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.aqua.algorithms</span> <span class="kn">import</span> <span class="n">VQE</span><span class="p">,</span> <span class="n">NumPyEigensolver</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qiskit.chemistry.components.variational_forms</span> <span class="kn">import</span> <span class="n">UCCSD</span>
<span class="kn">from</span> <span class="nn">qiskit.chemistry.components.initial_states</span> <span class="kn">import</span> <span class="n">HartreeFock</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">EfficientSU2</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua.components.optimizers</span> <span class="kn">import</span> <span class="n">COBYLA</span><span class="p">,</span> <span class="n">SPSA</span><span class="p">,</span> <span class="n">SLSQP</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua.operators</span> <span class="kn">import</span> <span class="n">Z2Symmetries</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">IBMQ</span><span class="p">,</span> <span class="n">BasicAer</span><span class="p">,</span> <span class="n">Aer</span>
<span class="kn">from</span> <span class="nn">qiskit.chemistry.drivers</span> <span class="kn">import</span> <span class="n">PySCFDriver</span><span class="p">,</span> <span class="n">UnitsType</span>
<span class="kn">from</span> <span class="nn">qiskit.chemistry</span> <span class="kn">import</span> <span class="n">FermionicOperator</span>
<span class="kn">from</span> <span class="nn">qiskit.aqua</span> <span class="kn">import</span> <span class="n">QuantumInstance</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.mitigation.measurement</span> <span class="kn">import</span> <span class="n">CompleteMeasFitter</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.aer.noise</span> <span class="kn">import</span> <span class="n">NoiseModel</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Running-VQE-on-a-Statevector-Simulator">Running VQE on a Statevector Simulator<a id="implementationstatevec" /><a class="anchor-link" href="#Running-VQE-on-a-Statevector-Simulator"> </a></h3><p>We demonstrate the calculation of the ground state energy for LiH at various interatomic distances. A driver for the molecule must be created at each such distance. Note that in this experiment, to reduce the number of qubits used, we freeze the core and remove two unoccupied orbitals. First, we define a function that takes an interatomic distance and returns the appropriate qubit operator, $H$, as well as some other information about the operator.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_qubit_op</span><span class="p">(</span><span class="n">dist</span><span class="p">):</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">PySCFDriver</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s2">&quot;Li .0 .0 .0; H .0 .0 &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dist</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="n">UnitsType</span><span class="o">.</span><span class="n">ANGSTROM</span><span class="p">,</span> 
                         <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
    <span class="n">molecule</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">freeze_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">remove_list</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">repulsion_energy</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span>
    <span class="n">num_particles</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">num_alpha</span> <span class="o">+</span> <span class="n">molecule</span><span class="o">.</span><span class="n">num_beta</span>
    <span class="n">num_spin_orbitals</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">num_orbitals</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="n">remove_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">%</span> <span class="n">molecule</span><span class="o">.</span><span class="n">num_orbitals</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">remove_list</span><span class="p">]</span>
    <span class="n">freeze_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">%</span> <span class="n">molecule</span><span class="o">.</span><span class="n">num_orbitals</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">freeze_list</span><span class="p">]</span>
    <span class="n">remove_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">freeze_list</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">remove_list</span><span class="p">]</span>
    <span class="n">remove_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">molecule</span><span class="o">.</span><span class="n">num_orbitals</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">freeze_list</span><span class="p">)</span>  <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">remove_list</span><span class="p">]</span>
    <span class="n">freeze_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">molecule</span><span class="o">.</span><span class="n">num_orbitals</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">freeze_list</span><span class="p">]</span>
    <span class="n">ferOp</span> <span class="o">=</span> <span class="n">FermionicOperator</span><span class="p">(</span><span class="n">h1</span><span class="o">=</span><span class="n">molecule</span><span class="o">.</span><span class="n">one_body_integrals</span><span class="p">,</span> <span class="n">h2</span><span class="o">=</span><span class="n">molecule</span><span class="o">.</span><span class="n">two_body_integrals</span><span class="p">)</span>
    <span class="n">ferOp</span><span class="p">,</span> <span class="n">energy_shift</span> <span class="o">=</span> <span class="n">ferOp</span><span class="o">.</span><span class="n">fermion_mode_freezing</span><span class="p">(</span><span class="n">freeze_list</span><span class="p">)</span>
    <span class="n">num_spin_orbitals</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">freeze_list</span><span class="p">)</span>
    <span class="n">num_particles</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">freeze_list</span><span class="p">)</span>
    <span class="n">ferOp</span> <span class="o">=</span> <span class="n">ferOp</span><span class="o">.</span><span class="n">fermion_mode_elimination</span><span class="p">(</span><span class="n">remove_list</span><span class="p">)</span>
    <span class="n">num_spin_orbitals</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">remove_list</span><span class="p">)</span>
    <span class="n">qubitOp</span> <span class="o">=</span> <span class="n">ferOp</span><span class="o">.</span><span class="n">mapping</span><span class="p">(</span><span class="n">map_type</span><span class="o">=</span><span class="s1">&#39;parity&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.00000001</span><span class="p">)</span>
    <span class="n">qubitOp</span> <span class="o">=</span> <span class="n">Z2Symmetries</span><span class="o">.</span><span class="n">two_qubit_reduction</span><span class="p">(</span><span class="n">qubitOp</span><span class="p">,</span> <span class="n">num_particles</span><span class="p">)</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">energy_shift</span> <span class="o">+</span> <span class="n">repulsion_energy</span>
    <span class="k">return</span> <span class="n">qubitOp</span><span class="p">,</span> <span class="n">num_particles</span><span class="p">,</span> <span class="n">num_spin_orbitals</span><span class="p">,</span> <span class="n">shift</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First, the exact ground state energy is calculated using the qubit operator and a classical exact eigensolver. Subsequently, the initial state $|\psi\rangle$ is created, which the VQE instance uses to produce the final ansatz $\min_{\theta}(|\psi(\theta)\rangle)$. The exact result and the VQE result at each interatomic distance is stored. Observe that the result given by <code>vqe.run(backend)['energy'] + shift</code> is equivalent the quantity $\min_{\theta}\left(\langle \psi(\theta)|H|\psi(\theta)\rangle\right)$, where the minimum is not necessarily the global minimum.</p>
<p>When initializing the VQE instance with <code>VQE(qubitOp, var_form, optimizer, 'matrix')</code> the expectation value of $H$ on $|\psi(\theta)\rangle$ is directly calculated through matrix multiplication. However, when using an actual quantum device, or a true simulator such as the <code>qasm_simulator</code> with <code>VQE(qubitOp, var_form, optimizer, 'paulis')</code> the calculation of the expectation value is more complicated. A Hamiltonian may be represented as a sum of a Pauli strings, with each Pauli term acting on a qubit as specified by the mapping being used. Each Pauli string has a corresponding circuit appended to the circuit corresponding to $|\psi(\theta)\rangle$. Subsequently, each of these circuits is executed, and all of the results are used to determine the expectation value of $H$ on $|\psi(\theta)\rangle$. In the following example, we initialize the VQE instance with <code>matrix</code> mode, and so the expectation value is directly calculated through matrix multiplication.</p>
<p>Note that the following code snippet may take a few minutes to run to completion.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_output_scroll">

<div class="cell border-box-sizing code_cell rendered tag_output_scroll">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">backend</span> <span class="o">=</span> <span class="n">BasicAer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s2">&quot;statevector_simulator&quot;</span><span class="p">)</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">exact_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">vqe_energies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">SLSQP</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">distances</span><span class="p">:</span>
    <span class="n">qubitOp</span><span class="p">,</span> <span class="n">num_particles</span><span class="p">,</span> <span class="n">num_spin_orbitals</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="n">get_qubit_op</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">NumPyEigensolver</span><span class="p">(</span><span class="n">qubitOp</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">exact_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">)</span> <span class="o">+</span> <span class="n">shift</span><span class="p">)</span>
    <span class="n">initial_state</span> <span class="o">=</span> <span class="n">HartreeFock</span><span class="p">(</span>
        <span class="n">num_spin_orbitals</span><span class="p">,</span>
        <span class="n">num_particles</span><span class="p">,</span>
        <span class="n">qubit_mapping</span><span class="o">=</span><span class="s1">&#39;parity&#39;</span>
    <span class="p">)</span> 
    <span class="n">var_form</span> <span class="o">=</span> <span class="n">UCCSD</span><span class="p">(</span>
        <span class="n">num_orbitals</span><span class="o">=</span><span class="n">num_spin_orbitals</span><span class="p">,</span>
        <span class="n">num_particles</span><span class="o">=</span><span class="n">num_particles</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
        <span class="n">qubit_mapping</span><span class="o">=</span><span class="s1">&#39;parity&#39;</span>
    <span class="p">)</span>
    <span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">qubitOp</span><span class="p">,</span> <span class="n">var_form</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">)</span>
    <span class="n">vqe_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">backend</span><span class="p">)[</span><span class="s1">&#39;eigenvalue&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">shift</span><span class="p">)</span>
    <span class="n">vqe_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vqe_result</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Interatomic Distance:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">dist</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s2">&quot;VQE Result:&quot;</span><span class="p">,</span> <span class="n">vqe_result</span><span class="p">,</span> <span class="s2">&quot;Exact Energy:&quot;</span><span class="p">,</span> <span class="n">exact_energies</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All energies have been calculated&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Interatomic Distance: 0.5 VQE Result: -7.039710215379314 Exact Energy: [-7.03973252]
Interatomic Distance: 0.6 VQE Result: -7.313344303226737 Exact Energy: [-7.31334583]
Interatomic Distance: 0.7 VQE Result: -7.500921096057088 Exact Energy: [-7.50092209]
Interatomic Distance: 0.8 VQE Result: -7.6309769149071265 Exact Energy: [-7.63097825]
Interatomic Distance: 0.9 VQE Result: -7.720810794644169 Exact Energy: [-7.72081241]
Interatomic Distance: 1.0 VQE Result: -7.782240655784512 Exact Energy: [-7.7822424]
Interatomic Distance: 1.1 VQE Result: -7.823597493382595 Exact Energy: [-7.82359928]
Interatomic Distance: 1.2 VQE Result: -7.850696622382944 Exact Energy: [-7.85069838]
Interatomic Distance: 1.3 VQE Result: -7.867561602146681 Exact Energy: [-7.86756329]
Interatomic Distance: 1.4 VQE Result: -7.876999876364884 Exact Energy: [-7.87700149]
Interatomic Distance: 1.5 VQE Result: -7.881014173918588 Exact Energy: [-7.88101572]
Interatomic Distance: 1.6 VQE Result: -7.881070663277413 Exact Energy: [-7.88107204]
Interatomic Distance: 1.7 VQE Result: -7.878267162103786 Exact Energy: [-7.87826817]
Interatomic Distance: 1.8 VQE Result: -7.873440112020817 Exact Energy: [-7.87344029]
Interatomic Distance: 1.9 VQE Result: -7.867233666618265 Exact Energy: [-7.86723396]
Interatomic Distance: 2.0 VQE Result: -7.860152328043125 Exact Energy: [-7.86015321]
Interatomic Distance: 2.1 VQE Result: -7.852595105806076 Exact Energy: [-7.85259583]
Interatomic Distance: 2.2 VQE Result: -7.844878726181193 Exact Energy: [-7.84487909]
Interatomic Distance: 2.3 VQE Result: -7.837257439443965 Exact Energy: [-7.83725797]
Interatomic Distance: 2.4 VQE Result: -7.8299350445800435 Exact Energy: [-7.829937]
Interatomic Distance: 2.5 VQE Result: -7.823070191944695 Exact Energy: [-7.82307664]
Interatomic Distance: 2.6 VQE Result: -7.816782592132487 Exact Energy: [-7.81679515]
Interatomic Distance: 2.7 VQE Result: -7.811153437640691 Exact Energy: [-7.81116828]
Interatomic Distance: 2.8 VQE Result: -7.80621829754091 Exact Energy: [-7.80622956]
Interatomic Distance: 2.9 VQE Result: -7.801962397987873 Exact Energy: [-7.8019736]
Interatomic Distance: 3.0 VQE Result: -7.798352411305384 Exact Energy: [-7.79836343]
Interatomic Distance: 3.1 VQE Result: -7.795326815802424 Exact Energy: [-7.79534045]
Interatomic Distance: 3.2 VQE Result: -7.792800696732087 Exact Energy: [-7.79283481]
Interatomic Distance: 3.3 VQE Result: -7.790603797885796 Exact Energy: [-7.79077401]
Interatomic Distance: 3.4 VQE Result: -7.788715355036123 Exact Energy: [-7.7890889]
Interatomic Distance: 3.5 VQE Result: -7.78721577056921 Exact Energy: [-7.78771697]
Interatomic Distance: 3.6 VQE Result: -7.786080395256832 Exact Energy: [-7.78660376]
Interatomic Distance: 3.7 VQE Result: -7.785203510040527 Exact Energy: [-7.78570291]
Interatomic Distance: 3.8 VQE Result: -7.784479536529381 Exact Energy: [-7.78497559]
Interatomic Distance: 3.9 VQE Result: -7.783853365368745 Exact Energy: [-7.78438961]
All energies have been calculated
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">exact_energies</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact Energy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">vqe_energies</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;VQE Energy&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Atomic distance (Angstrom)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/ch-applications/vqe-molecules_20_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the VQE results are very close to the exact results, and so the exact energy curve is hidden by the VQE curve.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Running-VQE-on-a-Noisy-Simulator">Running VQE on a Noisy Simulator<a id="implementationnoisy" /><a class="anchor-link" href="#Running-VQE-on-a-Noisy-Simulator"> </a></h3><p>Here, we calculate the ground state energy for H$_2$ using a noisy simulator and error mitigation.</p>
<p>First, we prepare the qubit operator representing the molecule's Hamiltonian:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">driver</span> <span class="o">=</span> <span class="n">PySCFDriver</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;H .0 .0 -0.3625; H .0 .0 0.3625&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">UnitsType</span><span class="o">.</span><span class="n">ANGSTROM</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
<span class="n">molecule</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">num_particles</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">num_alpha</span> <span class="o">+</span> <span class="n">molecule</span><span class="o">.</span><span class="n">num_beta</span>
<span class="n">qubitOp</span> <span class="o">=</span> <span class="n">FermionicOperator</span><span class="p">(</span><span class="n">h1</span><span class="o">=</span><span class="n">molecule</span><span class="o">.</span><span class="n">one_body_integrals</span><span class="p">,</span> <span class="n">h2</span><span class="o">=</span><span class="n">molecule</span><span class="o">.</span><span class="n">two_body_integrals</span><span class="p">)</span><span class="o">.</span><span class="n">mapping</span><span class="p">(</span><span class="n">map_type</span><span class="o">=</span><span class="s1">&#39;parity&#39;</span><span class="p">)</span>
<span class="n">qubitOp</span> <span class="o">=</span> <span class="n">Z2Symmetries</span><span class="o">.</span><span class="n">two_qubit_reduction</span><span class="p">(</span><span class="n">qubitOp</span><span class="p">,</span> <span class="n">num_particles</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we load a device coupling map and noise model from the IBMQ provider and create a quantum instance, enabling error mitigation:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_uses-hardware">

<div class="cell border-box-sizing code_cell rendered tag_uses-hardware">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">IBMQ</span><span class="o">.</span><span class="n">load_account</span><span class="p">()</span>
<span class="n">provider</span> <span class="o">=</span> <span class="n">IBMQ</span><span class="o">.</span><span class="n">get_provider</span><span class="p">(</span><span class="n">hub</span><span class="o">=</span><span class="s1">&#39;ibm-q&#39;</span><span class="p">)</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s2">&quot;qasm_simulator&quot;</span><span class="p">)</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s2">&quot;ibmq_lima&quot;</span><span class="p">)</span>
<span class="n">coupling_map</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">coupling_map</span>
<span class="n">noise_model</span> <span class="o">=</span> <span class="n">NoiseModel</span><span class="o">.</span><span class="n">from_backend</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">properties</span><span class="p">())</span>
<span class="n">quantum_instance</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> 
                                   <span class="n">shots</span><span class="o">=</span><span class="mi">8192</span><span class="p">,</span> 
                                   <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> 
                                   <span class="n">coupling_map</span><span class="o">=</span><span class="n">coupling_map</span><span class="p">,</span>
                                   <span class="n">measurement_error_mitigation_cls</span><span class="o">=</span><span class="n">CompleteMeasFitter</span><span class="p">,</span>
                                   <span class="n">cals_matrix_refresh_period</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqfactory.py:192: UserWarning: Timestamps in IBMQ backend properties, jobs, and job results are all now in local time instead of UTC.
  warnings.warn(&#39;Timestamps in IBMQ backend properties, jobs, and job results &#39;
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we must configure the optimizer, the variational form, and the VQE instance. As the effects of noise increase as the number of two qubit gates circuit depth increase, we use a heuristic variational form (RYRZ) rather than UCCSD as RYRZ has a much shallower circuit than UCCSD and uses substantially fewer two qubit gates.</p>
<p>The following code may take a few minutes to run to completion.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_uses-hardware">

<div class="cell border-box-sizing code_cell rendered tag_uses-hardware">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">exact_solution</span> <span class="o">=</span> <span class="n">NumPyEigensolver</span><span class="p">(</span><span class="n">qubitOp</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exact Result:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">exact_solution</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">)</span> <span class="o">+</span> <span class="n">molecule</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">SPSA</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">var_form</span> <span class="o">=</span> <span class="n">EfficientSU2</span><span class="p">(</span><span class="n">qubitOp</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">entanglement</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">)</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">qubitOp</span><span class="p">,</span> <span class="n">var_form</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">)</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">quantum_instance</span><span class="p">)</span>
<span class="n">vqe_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="s1">&#39;eigenvalue&#39;</span><span class="p">]</span><span class="o">+</span> <span class="n">molecule</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;VQE Result:&quot;</span><span class="p">,</span> <span class="n">vqe_result</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Exact Result: [-1.13722138]
VQE Result: -1.0949628247613228
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When noise mitigation is enabled, even though the result does not fall within chemical accuracy (defined as being within 0.0016 Hartree of the exact result), it is fairly close to the exact solution.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Problems">Problems<a id="problems" /><a class="anchor-link" href="#Problems"> </a></h2><ol>
<li>You are given a Hamiltonian $H$ with the promise that its ground state is close to a maximally entangled $n$ qubit state. Explain which variational form (or forms) is likely to efficiently and accurately learn the ground state energy of $H$. You may also answer by creating your own variational form, and explaining why it is appropriate for use with this Hamiltonian. </li>
<li>Calculate the number of circuit evaluations performed per optimization iteration, when using the COBYLA optimizer, the <code>qasm_simulator</code> with 1000 shots, and a Hamiltonian with 60 Pauli strings.</li>
<li>Use VQE to estimate the ground state energy of BeH$_2$ with an interatomic distance of $1.3$. You may re-use the function <code>get_qubit_op(dist)</code> by replacing <code>atom="Li .0 .0 .0; H .0 .0 " + str(dist)</code> with <code>atom="Be .0 .0 .0; H .0 .0 -" + str(dist) + "; H .0 .0 " + str(dist)</code> and invoking the function with <code>get_qubit_op(1.3)</code>. Note that removing the unoccupied orbitals does not preserve chemical precision for this molecule. However, to get the number of qubits  required down to 6 (and thereby allowing efficient simulation on most laptops), the loss of precision is acceptable. While beyond the scope of this exercise, the interested reader may use qubit tapering operations to reduce the number of required qubits to 7, without losing any chemical precision.</li>
</ol>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a id="references" /><a class="anchor-link" href="#References"> </a></h2><ol>
<li>Peruzzo, Alberto, et al. "A variational eigenvalue solver on a photonic quantum processor." <em>Nature communications</em> 5 (2014): 4213.</li>
<li>Griffiths, David J., and Darrell F. Schroeter. Introduction to quantum mechanics. <em>Cambridge University Press</em>, 2018.</li>
<li>Shende, Vivek V., Igor L. Markov, and Stephen S. Bullock. "Minimal universal two-qubit cnot-based circuits." arXiv preprint quant-ph/0308033 (2003).</li>
<li>Kandala, Abhinav, et al. "Hardware-efficient variational quantum eigensolver for small molecules and quantum magnets." Nature 549.7671 (2017): 242.</li>
</ol>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">qiskit</span>
<span class="n">qiskit</span><span class="o">.</span><span class="n">__qiskit_version__</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;qiskit-terra&#39;: &#39;0.16.0&#39;,
 &#39;qiskit-aer&#39;: &#39;0.7.0&#39;,
 &#39;qiskit-ignis&#39;: &#39;0.5.0&#39;,
 &#39;qiskit-ibmq-provider&#39;: &#39;0.11.0&#39;,
 &#39;qiskit-aqua&#39;: &#39;0.8.0&#39;,
 &#39;qiskit&#39;: &#39;0.23.0&#39;}</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

 


    </main>
    
            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  
    
    

    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/textbook/ch-applications/hhl_tutorial.html">
       <span class="u-margin-right-tiny"></span> Solving Linear Systems of Equation...
    </a>
  

  
    

    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/textbook/ch-applications/qaoa.html">
      Solving combinatorial optimization... <span class="u-margin-right-tiny"></span> 
    </a>
  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="https://github.com/jupyter/jupyter-book/graphs/contributors">The Jupyter Book Community</a></p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
